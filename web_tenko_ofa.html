<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <title>OFA GROUP ä¹—å‹™è¨˜éŒ²ãƒ»æ—¥å¸¸ç‚¹æ¤œãƒ»é‹è»¢æ—¥å ±</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    /* ------------------------------------------------------------------- */
    /* CSS: ã‚¹ã‚¿ã‚¤ãƒ«ã¯å…ƒã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç¶­æŒã—ã¤ã¤ã€ä¸€éƒ¨ã®è¦ç´ ã‚’èª¿æ•´ã—ã¦ã„ã¾ã™ */
    /* ------------------------------------------------------------------- */
    * { box-sizing: border-box; }
    :root {
      --color-primary: #22c55e;
      --color-primary-dark: #16a34a; 
      --color-required: #ef4444;
      --color-background: #e6f7ec;
    }
    body {
      margin: 0;
      padding: 0;
      font-family: -apple-system, BlinkMacSystemFont, "Helvetica Neue", Arial, "Noto Sans JP", sans-serif;
      background: var(--color-background);
      color: #222;
    }
    .wrapper {
      max-width: 640px;
      margin: 0 auto 80px;
      padding: 16px;
    }
    .card {
      background: #fff;
      border-radius: 24px;
      box-shadow: 0 10px 25px rgba(0,0,0,0.08);
      padding: 20px 18px 24px;
      margin-bottom: 16px;
      transition: opacity 0.3s ease; /* ã‚»ã‚¯ã‚·ãƒ§ãƒ³åˆ‡ã‚Šæ›¿ãˆæ™‚ã®ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ */
    }
    .card.hidden { display: none; } /* éè¡¨ç¤ºã‚»ã‚¯ã‚·ãƒ§ãƒ³ç”¨ */
    .header-card {
      background: linear-gradient(135deg, var(--color-primary), var(--color-primary-dark));
      color: #fff;
      text-align: left;
      position: relative;
      overflow: hidden;
    }
    .header-card::before {
      content: "";
      position: absolute;
      right: -60px;
      top: -60px;
      width: 160px;
      height: 160px;
      border-radius: 50%;
      border: 18px solid rgba(255,255,255,0.35);
    }
    .logo-box {
      width: 70px;
      height: 70px;
      border-radius: 20px;
      background: #fff;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 900;
      font-size: 26px;
      color: #222;
      margin-bottom: 12px;
    }
    .logo-box span:nth-child(1) { color: #ef4444; } /* O: red   */
    .logo-box span:nth-child(2) { color: #facc15; } /* F: yellow*/
    .logo-box span:nth-child(3) { color: #3b82f6; } /* A: blue  */

    h1 {
      margin: 4px 0 6px;
      font-size: 18px;
      line-height: 1.4;
    }
    .subtitle {
      font-size: 11px;
      opacity: 0.9;
      margin-bottom: 4px;
    }
    .tagline {
      font-size: 11px;
      opacity: 0.9;
    }
    .tagline b { font-weight: 700; }

    .section-title {
      display: flex;
      align-items: center;
      margin-bottom: 8px;
      font-size: 15px;
      font-weight: 700;
    }
    .section-chip {
      background: #facc15;
      color: #111827;
      font-weight: 900;
      font-size: 11px;
      border-radius: 999px;
      padding: 4px 10px;
      margin-right: 8px;
    }
    .section-title small {
      font-weight: 500;
      font-size: 12px;
      color: #6b7280;
      margin-left: 4px;
    }
    .note {
      font-size: 11px;
      color: #6b7280;
      line-height: 1.5;
      margin-bottom: 12px;
    }
    .note-important {
      color: var(--color-required);
      font-weight: 700;
    }

    label {
      display: block;
      font-size: 12px;
      font-weight: 600;
      margin: 12px 2px 4px;
    }
    label span.req {
      color: var(--color-required);
      margin-left: 4px;
      font-weight: 700;
    }
    input[type="text"],
    input[type="email"],
    input[type="number"],
    input[type="time"],
    textarea,
    select {
      width: 100%;
      border-radius: 12px;
      border: 1px solid #d1d5db;
      padding: 10px 12px;
      font-size: 14px;
      outline: none;
      transition: border-color 0.15s, box-shadow 0.15s;
      background: #f9fafb;
    }
    input:focus,
    textarea:focus,
    select:focus {
      border-color: var(--color-primary);
      box-shadow: 0 0 0 1px rgba(34,197,94,0.35);
      background: #fff;
    }
    textarea {
      min-height: 72px;
      resize: vertical;
    }
    .help {
      font-size: 11px;
      color: #9ca3af;
      margin-top: 2px;
    }

    .radio-group,
    .check-group {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      margin-top: 4px;
    }
    .pill {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      padding: 6px 14px;
      border-radius: 999px;
      border: 1px solid #d1d5db;
      font-size: 12px;
      background: #f9fafb;
      cursor: pointer;
      user-select: none;
    }
    .pill input {
      display: none;
    }
    .pill.selected {
      background: var(--color-primary);
      color: #fff;
      border-color: var(--color-primary-dark);
      font-weight: 600;
    }

    .two-col {
      display: flex;
      gap: 8px;
    }
    .two-col > div { flex: 1; }

    .section-footer-note {
      font-size: 11px;
      color: #6b7280;
      margin-top: 4px;
    }

    .submit-btn {
      width: 100%;
      border: none;
      border-radius: 999px;
      padding: 16px 12px;
      font-size: 16px;
      font-weight: 800;
      background: linear-gradient(135deg, var(--color-primary), var(--color-primary-dark));
      color: #fff;
      box-shadow: 0 10px 20px rgba(16,185,129,0.4);
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      margin-top: 12px;
      transition: background 0.3s, box-shadow 0.3s;
    }
    .submit-btn span.icon {
      font-size: 18px;
    }
    .submit-btn:disabled {
      background: #9ca3af;
      box-shadow: none;
      cursor: not-allowed;
    }

    .status-message {
      margin-top: 10px;
      font-size: 13px;
      line-height: 1.5;
    }
    .status-success {
      color: var(--color-primary-dark);
    }
    .status-error {
      color: var(--color-required);
    }

    @media (max-width: 480px) {
      .header-card {
        padding-top: 16px;
      }
    }
  </style>
</head>
<body>
  <div class="wrapper">
    <div class="card header-card">
      <div class="logo-box">
        <span>O</span><span>F</span><span>A</span>
      </div>
      <div class="subtitle">OFA GROUP WEBç‚¹å‘¼ ï¼† æ—¥å ±ãƒ•ã‚©ãƒ¼ãƒ </div>
      <h1>ä¹—å‹™è¨˜éŒ²ãƒ»æ—¥å¸¸ç‚¹æ¤œãƒ»é‹è»¢æ—¥å ±</h1>
      <div class="tagline">
        <b>ONE FOR ALL, ALL FOR ONE</b><br />
        å®‰å…¨é‹è»¢ãƒ»ã‚³ãƒ³ãƒ—ãƒ©ã‚¤ã‚¢ãƒ³ã‚¹ã‚’å®ˆã‚‹ãŸã‚ã®<br />
        OFA GROUP ãƒ‰ãƒ©ã‚¤ãƒãƒ¼å°‚ç”¨ãƒ•ã‚©ãƒ¼ãƒ ã§ã™ã€‚
      </div>
    </div>

    <div class="card" id="section-01">
      <div class="section-title">
        <div class="section-chip">01 åŸºæœ¬æƒ…å ±</div>
        <span>æœ¬æ—¥ã®æƒ…å ±ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„</span>
      </div>
      <div class="note">
        â€» æ—¥ä»˜ã¯è‡ªå‹•ã§æœ¬æ—¥ãŒå…¥ã‚Šã¾ã™ã€‚<br />
        <span class="note-important">â€» **æœã®å‡ºç™ºå‰**ã¨**å¤œã®å¸°åº«å¾Œ**ã§ã€ã“ã®ãƒ•ã‚©ãƒ¼ãƒ ã‚’<span id="submitCountText">2å›é€ä¿¡</span>ã—ã¦ãã ã•ã„ã€‚</span><br />
      </div>

      <label>æ—¥ä»˜ <span class="req">å¿…é ˆ</span></label>
      <input type="text" id="date" readonly />

      <label>ãƒ‰ãƒ©ã‚¤ãƒãƒ¼å <span class="req">å¿…é ˆ</span></label>
      <input type="text" id="driverName" placeholder="å±±ç”° å¤ªéƒ ãªã©" data-local-save="true" />

      <label>æ‰€å±ä¼šç¤¾ <span class="req">å¿…é ˆ</span></label>
      <input type="text" id="company" placeholder="æ ªå¼ä¼šç¤¾OFA ãªã©" data-local-save="true" />

      <label>æœ¬æ—¥ã®ä¸»ãªæ¡ˆä»¶ï¼ˆè·ä¸»ãƒ»ç¾å ´åï¼‰ <span class="req">å¿…é ˆ</span></label>
      <input type="text" id="client" placeholder="Amazon / ãƒ¤ãƒãƒˆ / ä½å· / æ—¥æœ¬éƒµä¾¿ ãªã©" data-local-save="true" />

      <label>ã‚¨ãƒªã‚¢ <span class="req">å¿…é ˆ</span></label>
      <input type="text" id="area" placeholder="é¹¿å…å³¶å¸‚ã€‡ã€‡ / ç†Šæœ¬å¸‚ã€‡ã€‡ ãªã©" data-local-save="true" />

      <label>å‡ºåº«ãƒ™ãƒ¼ã‚¹ï¼ˆæ‹…å½“æ‹ ç‚¹ï¼‰ <span class="req">å¿…é ˆ</span></label>
      <input type="text" id="base" placeholder="ä¼Šæ•·å–¶æ¥­æ‰€ / ã€‡ã€‡ãƒ‡ãƒ ãªã©" data-local-save="true" />

      <label>å‡ºåº«å ´æ‰€ï¼ˆé§è»Šå ´ãƒ»ã‚»ãƒ³ã‚¿ãƒ¼ãªã©ï¼‰ <span class="req">å¿…é ˆ</span></label>
      <input type="text" id="startPlace" placeholder="é¹¿å…å³¶å¸‚ã€‡ã€‡é§è»Šå ´ ãªã©" data-local-save="true" />

      <label>ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ï¼ˆæ§ãˆé€ä¿¡ç”¨ï¼‰</label>
      <input type="email" id="email" placeholder="example@ofa-group.jp" data-local-save="true" />
      <div class="help">â€» å…¥åŠ›ã™ã‚‹ã¨ã€ç‚¹å‘¼çµæœã®ã‚³ãƒ”ãƒ¼ãŒå±Šãã¾ã™ã€‚</div>
    </div>

    <div class="card" id="section-02">
      <div class="section-title">
        <div class="section-chip">02 å‡ºç™ºå‰ç‚¹å‘¼</div>
        <span>å‡ºå‹¤å‰ã€œå‡ºç™ºæ™‚ã®çŠ¶æ…‹ã‚’è¨˜éŒ² <span class="req">ï¼ˆæœå¿…é ˆï¼‰</span></span>
      </div>

      <div class="two-col">
        <div>
          <label>å‡ºå‹¤æ™‚é–“ <span class="req">å¿…é ˆ</span></label>
          <input type="time" id="workTime" />
        </div>
        <div>
          <label>å‡ºç™ºæ™‚é–“ <span class="req">å¿…é ˆ</span></label>
          <input type="time" id="startTime" />
        </div>
      </div>

      <label>ä½“èª¿ <span class="req">å¿…é ˆ</span></label>
      <div class="radio-group" data-name="condition">
        <label class="pill"><input type="radio" name="condition" value="è‰¯å¥½">è‰¯å¥½</label>
        <label class="pill"><input type="radio" name="condition" value="æ™®é€š">æ™®é€š</label>
        <label class="pill"><input type="radio" name="condition" value="ä¸è‰¯">ä¸è‰¯</label>
      </div>

      <label>å‰æ—¥ç¡çœ æ™‚é–“ï¼ˆhï¼‰ <span class="req">å¿…é ˆ</span></label>
      <input type="number" step="0.1" id="sleep" placeholder="ä¾‹ï¼š6.5" />

      <label>é£²é…’ï¼ˆéå»24hï¼‰ <span class="req">å¿…é ˆ</span></label>
      <div class="radio-group" data-name="drink">
        <label class="pill"><input type="radio" name="drink" value="ãªã—">ãªã—</label>
        <label class="pill"><input type="radio" name="drink" value="ã‚ã‚Š">ã‚ã‚Š</label>
      </div>

      <label>æœè–¬ <span class="req">å¿…é ˆ</span></label>
      <div class="radio-group" data-name="medicine">
        <label class="pill"><input type="radio" name="medicine" value="ãªã—">ãªã—</label>
        <label class="pill"><input type="radio" name="medicine" value="ã‚ã‚Š">ã‚ã‚Š</label>
      </div>

      <label>ä½“æ¸©ï¼ˆâ„ƒï¼‰ <span class="req">å¿…é ˆ</span></label>
      <input type="number" step="0.1" id="temp" placeholder="ä¾‹ï¼š36.5" />

      <label>ã‚¢ãƒ«ã‚³ãƒ¼ãƒ«æ¤œçŸ¥å™¨ï¼ˆmg/Lï¼‰ <span class="req">å¿…é ˆ</span></label>
      <input type="number" step="0.01" id="alcoholValue" placeholder="0.00" />

      <label>å‡ºç™ºå‰ãƒ¡ãƒ¼ã‚¿ãƒ¼ï¼ˆkmï¼‰ <span class="req">å¿…é ˆ</span></label>
      <input type="number" step="0.1" id="startMeter" placeholder="ä¾‹ï¼š47772" />

      <label>é‹è»¢å…è¨±è¨¼ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰</label>
      <input type="file" id="licenseFile" accept="image/*" />
      <div class="help">â€» åˆå›ã®ã¿ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã—ã¦ãã ã•ã„ã€‚</div>

      <label>ãƒ¡ãƒ¢ãƒ»æ³¨æ„äº‹é …</label>
      <textarea id="memo" placeholder="ä½“èª¿ãƒ»è»Šä¸¡ã®æ°—ã«ãªã‚‹ç‚¹ãƒ»å½“æ—¥ã®æ³¨æ„äº‹é …ãªã©"></textarea>
    </div>

    <div class="card" id="section-03">
      <div class="section-title">
        <div class="section-chip">03 æ—¥å¸¸ç‚¹æ¤œ</div>
        <span>å‡ºç™ºå‰ã®æ—¥å¸¸ç‚¹æ¤œã‚’å…¥åŠ› <span class="req">ï¼ˆæœå¿…é ˆï¼‰</span></span>
      </div>
      <div class="note">
        â—‹ï¼šå•é¡Œãªã— ï¼ â–³ï¼šè¦ç¢ºèª ï¼ Ã—ï¼šè¦æ•´å‚™ ã®3æ®µéšã§å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚
      </div>

      <label>ãƒ–ãƒ¬ãƒ¼ã‚­ <span class="req">å¿…é ˆ</span></label>
      <div class="radio-group" data-name="check_brake">
        <label class="pill"><input type="radio" name="check_brake" value="â—‹">â—‹</label>
        <label class="pill"><input type="radio" name="check_brake" value="â–³">â–³</label>
        <label class="pill"><input type="radio" name="check_brake" value="Ã—">Ã—</label>
      </div>

      <label>ã‚¿ã‚¤ãƒ¤ï¼ˆäº€è£‚ãƒ»æ‘©è€—ãƒ»ç©ºæ°—åœ§ï¼‰ <span class="req">å¿…é ˆ</span></label>
      <div class="radio-group" data-name="check_tire">
        <label class="pill"><input type="radio" name="check_tire" value="â—‹">â—‹</label>
        <label class="pill"><input type="radio" name="check_tire" value="â–³">â–³</label>
        <label class="pill"><input type="radio" name="check_tire" value="Ã—">Ã—</label>
      </div>

      <label>ç¯ç«é¡ï¼ˆãƒ˜ãƒƒãƒ‰ãƒ©ã‚¤ãƒˆãƒ»ãƒ–ãƒ¬ãƒ¼ã‚­ãƒ©ãƒ³ãƒ—ç­‰ï¼‰ <span class="req">å¿…é ˆ</span></label>
      <div class="radio-group" data-name="check_light">
        <label class="pill"><input type="radio" name="check_light" value="â—‹">â—‹</label>
        <label class="pill"><input type="radio" name="check_light" value="â–³">â–³</label>
        <label class="pill"><input type="radio" name="check_light" value="Ã—">Ã—</label>
      </div>

      <label>ãƒãƒƒã‚¯ã‚«ãƒ¡ãƒ©ãƒ»ãƒŸãƒ©ãƒ¼é¡ <span class="req">å¿…é ˆ</span></label>
      <div class="radio-group" data-name="check_camera">
        <label class="pill"><input type="radio" name="check_camera" value="â—‹">â—‹</label>
        <label class="pill"><input type="radio" name="check_camera" value="â–³">â–³</label>
        <label class="pill"><input type="radio" name="check_camera" value="Ã—">Ã—</label>
      </div>

      <label>è»Šä½“å¤–è¦³ï¼ˆå‚·ãƒ»å‡¹ã¿ãƒ»æ±šã‚Œç­‰ï¼‰ <span class="req">å¿…é ˆ</span></label>
      <div class="radio-group" data-name="check_body">
        <label class="pill"><input type="radio" name="check_body" value="â—‹">â—‹</label>
        <label class="pill"><input type="radio" name="check_body" value="â–³">â–³</label>
        <label class="pill"><input type="radio" name="check_body" value="Ã—">Ã—</label>
      </div>

      <label>ãã®ä»–ï¼ˆã‚ªã‚¤ãƒ«ãƒ»æ°´å›ã‚Šãƒ»ç©è¼‰ç‰©å›ºå®šãªã©ï¼‰ <span class="req">å¿…é ˆ</span></label>
      <div class="radio-group" data-name="check_other">
        <label class="pill"><input type="radio" name="check_other" value="â—‹">â—‹</label>
        <label class="pill"><input type="radio" name="check_other" value="â–³">â–³</label>
        <label class="pill"><input type="radio" name="check_other" value="Ã—">Ã—</label>
      </div>

      <label>ç‚¹æ¤œãƒ¡ãƒ¢</label>
      <textarea id="check_note" placeholder="æ°—ã«ãªã‚‹ç®‡æ‰€ãƒ»äº¤æ›äºˆå®šãƒ»æ•´å‚™äºˆç´„ãªã©"></textarea>

      <label>è»Šä¸¡ç•°å¸¸ç®‡æ‰€ã®å†™çœŸã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰</label>
      <input type="file" id="carAbnormalFile" accept="image/*" />
      <div class="help">â€» ç•°å¸¸ãŒã‚ã‚‹å ´åˆã®ã¿1æšã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã—ã¦ãã ã•ã„ã€‚ï¼ˆDriveã«ä¿å­˜ã•ã‚Œã€URLãŒæ—¥å ±ã«è¨˜éŒ²ã•ã‚Œã¾ã™ï¼‰</div>
    </div>

    <div class="card" id="section-04">
      <div class="section-title">
        <div class="section-chip">04 å¸°åº«å¾Œç‚¹å‘¼ãƒ»æ—¥å ±</div>
        <span>æ¥­å‹™çµ‚äº†æ™‚ã«å…¥åŠ›ã—ã¦ãã ã•ã„ <span class="req">ï¼ˆå¤œå¿…é ˆï¼‰</span></span>
      </div>
      <div class="note">
        ä¸€æ—¥ã®é‹è¡ŒãŒçµ‚ã‚ã£ãŸã‚‰ã€å¸°åº«å¾Œã®æƒ…å ±ã‚’å…¥åŠ›ã—ã¦ã‹ã‚‰é€ä¿¡ã—ã¦ãã ã•ã„ã€‚
      </div>

      <label>å¸°åº«å ´æ‰€ <span class="req">å¿…é ˆ</span></label>
      <input type="text" id="returnPlace" placeholder="é¹¿å…å³¶å¸‚ã€‡ã€‡é§è»Šå ´ ãªã©" />

      <div class="two-col">
        <div>
          <label>å¸°åº«æ™‚é–“ <span class="req">å¿…é ˆ</span></label>
          <input type="time" id="returnTime" />
        </div>
        <div>
          <label>å¸°åº«ãƒ¡ãƒ¼ã‚¿ãƒ¼ï¼ˆkmï¼‰ <span class="req">å¿…é ˆ</span></label>
          <input type="number" step="0.1" id="returnMeter" placeholder="ä¾‹ï¼š48210" />
        </div>
      </div>

      <label>èµ°è¡Œè·é›¢ï¼ˆkmï¼‰</label>
      <input type="number" step="0.1" id="distance" placeholder="â€» è‡ªå‹•ã§è¨ˆç®—ã•ã‚Œã¾ã™" readonly />

      <label>ä¼‘æ†©æ™‚é–“ãƒ»ä¼‘æ†©å ´æ‰€ <span class="req">å¿…é ˆ</span></label>
      <input type="text" id="rest" placeholder="ä¾‹ï¼šåˆè¨ˆ1h / SAãƒ»ã‚³ãƒ³ãƒ“ãƒ‹ãªã©" />

      <label>ä»£é‡‘å…¥é‡‘çŠ¶æ³ <span class="req">å¿…é ˆ</span></label>
      <div class="radio-group" data-name="codStatus">
        <label class="pill"><input type="radio" name="codStatus" value="å¯¾è±¡ãªã—">å¯¾è±¡ãªã—</label>
        <label class="pill"><input type="radio" name="codStatus" value="å…¥é‡‘æ¸ˆ">å…¥é‡‘æ¸ˆ</label>
        <label class="pill"><input type="radio" name="codStatus" value="æœªå…¥é‡‘">æœªå…¥é‡‘</label>
      </div>

      <label>ä»£é‡‘å…¥é‡‘é‡‘é¡ï¼ˆå††ï¼‰</label>
      <input type="number" step="1" id="codAmount" placeholder="ä¾‹ï¼š12500" />

      <label>é“è·¯ãƒ»é‹è¡ŒçŠ¶æ³ï¼ˆé…å»¶ãƒ»äº‹æ•…ãƒ»æ¸‹æ»ãªã©ï¼‰ <span class="req">å¿…é ˆ</span></label>
      <textarea id="roadStatus" placeholder="ç•°å¸¸ãªã—ã®å ´åˆã¯ã€ç•°å¸¸ãªã—ã€ã¨å…¥åŠ›"></textarea>

      <label>ç•°å¸¸ã®è©³ç´°ï¼ˆã‚ã‚Œã°ï¼‰</label>
      <textarea id="abnormalDetail" placeholder="äº‹æ•…ãƒ»ç‰©æãƒ»ã‚¯ãƒ¬ãƒ¼ãƒ ãªã©ã®æ¦‚è¦ã¨å¯¾å¿œ"></textarea>

      <div class="section-footer-note">
        â€» å…¥åŠ›å¾Œã€ã€ŒOFA GROUP Webç‚¹å‘¼ã‚’é€ä¿¡ã™ã‚‹ã€ã‚’æŠ¼ã™ã¨ã€æœ¬éƒ¨ã¨æœ¬äººï¼ˆãƒ¡ãƒ¼ãƒ«å…¥åŠ›æ™‚ï¼‰ã¸æ§ãˆãŒé€ä¿¡ã•ã‚Œã¾ã™ã€‚
      </div>

      <button id="submitBtn" class="submit-btn">
        <span class="icon">â˜€ï¸</span>
        <span id="submitBtnText">å‡ºç™ºç‚¹å‘¼ã‚’é€ä¿¡ã™ã‚‹</span>
      </button>
      <div id="status" class="status-message"></div>
    </div>
  </div>

  <script>
    // â˜… Apps Script ã® Webã‚¢ãƒ—ãƒªURL
    const SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbyzpyi0Mw4uDd_Wji1q0VcalWp5_mRMucEDdzaV_Vr6OPx2_ecqh7ZviPARq5MHPQvC/exec';
    
    // Local Storage Key
    const LOCAL_STORAGE_KEY = 'ofaTenkoData';
    const LOCAL_STORAGE_DATE_KEY = 'ofaTenkoDate';

    // ãƒ•ã‚©ãƒ¼ãƒ ã‚»ã‚¯ã‚·ãƒ§ãƒ³
    const sections = {
        base: document.getElementById('section-01'),
        morning: [document.getElementById('section-02'), document.getElementById('section-03')],
        evening: [document.getElementById('section-04')]
    };

    // -------------------------------------------------------------------
    // åˆæœŸå‡¦ç†
    // -------------------------------------------------------------------

    /**
     * æ—¥ä»˜ã‚’è‡ªå‹•ã‚»ãƒƒãƒˆ (YYYY/MM/DD)
     */
    function setToday() {
        const d = new Date();
        const y = d.getFullYear();
        const m = ('0' + (d.getMonth() + 1)).slice(-2);
        const day = ('0' + d.getDate()).slice(-2);
        const todayStr = `${y}/${m}/${day}`;
        document.getElementById('date').value = todayStr;
        return todayStr;
    }

    /**
     * LocalStorageã‹ã‚‰åŸºæœ¬æƒ…å ±ã¨ãƒ©ã‚¸ã‚ªãƒœã‚¿ãƒ³ã®çŠ¶æ…‹ã‚’èª­ã¿è¾¼ã‚€
     */
    function loadLocalStorage() {
        const todayStr = document.getElementById('date').value;
        const storedDate = localStorage.getItem(LOCAL_STORAGE_DATE_KEY);

        // æ—¥ä»˜ãŒå¤‰ã‚ã£ã¦ã„ãŸã‚‰å¤ã„ãƒ‡ãƒ¼ã‚¿ã‚’ã‚¯ãƒªã‚¢
        if (storedDate !== todayStr) {
            localStorage.removeItem(LOCAL_STORAGE_KEY);
            return;
        }

        const storedData = JSON.parse(localStorage.getItem(LOCAL_STORAGE_KEY) || '{}');

        // ãƒ†ã‚­ã‚¹ãƒˆãƒ»ãƒ¡ãƒ¼ãƒ«ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã®å¾©å…ƒ
        document.querySelectorAll('input[data-local-save="true"]').forEach(el => {
            if (storedData[el.id]) {
                el.value = storedData[el.id];
            }
        });
        
        // ãƒ©ã‚¸ã‚ªãƒœã‚¿ãƒ³ã®çŠ¶æ…‹ã‚’å¾©å…ƒ
        document.querySelectorAll('.radio-group').forEach(group => {
            const name = group.getAttribute('data-name');
            if (storedData[name]) {
                const input = document.querySelector(`input[name="${name}"][value="${storedData[name]}"]`);
                if (input) {
                    // pillé¸æŠã®è¦‹ãŸç›®ã‚‚å¾©å…ƒ
                    input.checked = true;
                    input.closest('.pill').classList.add('selected');
                }
            }
        });
    }

    /**
     * LocalStorageã«åŸºæœ¬æƒ…å ±ã¨ãƒ©ã‚¸ã‚ªãƒœã‚¿ãƒ³ã®çŠ¶æ…‹ã‚’ä¿å­˜ã™ã‚‹
     */
    function saveLocalStorage() {
        const dataToSave = {};
        
        // ãƒ†ã‚­ã‚¹ãƒˆãƒ»ãƒ¡ãƒ¼ãƒ«ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã®ä¿å­˜
        document.querySelectorAll('input[data-local-save="true"]').forEach(el => {
            dataToSave[el.id] = el.value.trim();
        });

        // ãƒ©ã‚¸ã‚ªãƒœã‚¿ãƒ³ã®çŠ¶æ…‹ã‚’ä¿å­˜
        document.querySelectorAll('.radio-group').forEach(group => {
            const name = group.getAttribute('data-name');
            const checked = document.querySelector(`input[name="${name}"]:checked`);
            if (checked) {
                dataToSave[name] = checked.value;
            }
        });

        localStorage.setItem(LOCAL_STORAGE_KEY, JSON.stringify(dataToSave));
        localStorage.setItem(LOCAL_STORAGE_DATE_KEY, document.getElementById('date').value);
    }
    
    /**
     * ãƒ•ã‚©ãƒ¼ãƒ ã®è¡¨ç¤ºçŠ¶æ…‹ã‚’åˆ¶å¾¡ã™ã‚‹
     * å¿…é ˆé …ç›®(driverName, company, date)ãŒåŸ‹ã¾ã£ã¦ã„ã‚Œã°æœ/å¤œã®åˆ¤å®šã‚’è¡Œã†
     */
    async function updateFormVisibility() {
        const driverName = document.getElementById('driverName').value.trim();
        const company = document.getElementById('company').value.trim();
        const date = document.getElementById('date').value;
        
        // åŸºæœ¬æƒ…å ±ãŒå…¥åŠ›ã•ã‚Œã¦ã„ãªã„å ´åˆã¯ã€å…¨ã¦è¡¨ç¤ºï¼ˆåˆå›å…¥åŠ›ï¼‰
        if (!driverName || !company || !date) {
            sections.morning.forEach(s => s.classList.remove('hidden'));
            sections.evening.forEach(s => s.classList.remove('hidden'));
            document.getElementById('submitBtnText').textContent = 'å‡ºç™ºç‚¹å‘¼ã‚’é€ä¿¡ã™ã‚‹';
            document.getElementById('submitBtn').querySelector('.icon').textContent = 'â˜€ï¸';
            document.getElementById('submitCountText').textContent = '2å›é€ä¿¡';
            return;
        }
        
        // --- éå»ã®é€ä¿¡å±¥æ­´ã‚’ç¢ºèªï¼ˆApp ScriptçµŒç”±ã§ï¼‰ ---
        const checkUrl = `${SCRIPT_URL}?action=check&driverName=${encodeURIComponent(driverName)}&date=${encodeURIComponent(date)}`;
        
        let sentBefore = false;
        try {
            const response = await fetch(checkUrl);
            const result = await response.json();
            sentBefore = result.sentBefore || false; 
        } catch(e) {
            console.error("é€ä¿¡å±¥æ­´ãƒã‚§ãƒƒã‚¯ã‚¨ãƒ©ãƒ¼", e);
            // ã‚¨ãƒ©ãƒ¼æ™‚ã‚‚å…¨ã¦ã®ãƒ•ã‚©ãƒ¼ãƒ ã‚’è¡¨ç¤ºã—ã¦ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«åˆ¤æ–­ã•ã›ã‚‹
            sentBefore = false;
        }
        
        if (sentBefore) {
            // â˜…å¤œï¼ˆå¸°åº«å¾Œï¼‰ã®å…¥åŠ›ãƒ¢ãƒ¼ãƒ‰
            sections.morning.forEach(s => s.classList.add('hidden')); // æœã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã‚’éè¡¨ç¤º
            sections.evening.forEach(s => s.classList.remove('hidden')); // å¤œã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã‚’è¡¨ç¤º
            document.getElementById('submitBtnText').textContent = 'å¸°åº«ç‚¹å‘¼ãƒ»æ—¥å ±ã‚’é€ä¿¡ã™ã‚‹';
            document.getElementById('submitBtn').querySelector('.icon').textContent = 'ğŸŒ™';
            document.getElementById('submitCountText').textContent = 'æœã®é€ä¿¡å®Œäº†æ¸ˆ';
        } else {
            // â˜…æœï¼ˆå‡ºç™ºå‰ï¼‰ã®å…¥åŠ›ãƒ¢ãƒ¼ãƒ‰
            sections.morning.forEach(s => s.classList.remove('hidden')); // æœã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã‚’è¡¨ç¤º
            sections.evening.forEach(s => s.classList.add('hidden')); // å¤œã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã‚’éè¡¨ç¤º
            document.getElementById('submitBtnText').textContent = 'å‡ºç™ºç‚¹å‘¼ã‚’é€ä¿¡ã™ã‚‹';
            document.getElementById('submitBtn').querySelector('.icon').textContent = 'â˜€ï¸';
            document.getElementById('submitCountText').textContent = '2å›é€ä¿¡';
        }
    }


    // -------------------------------------------------------------------
    // ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼
    // -------------------------------------------------------------------

    // pillé¸æŠã®è¦‹ãŸç›®åˆ‡æ›¿ã¨LocalStorageä¿å­˜
    document.querySelectorAll('.radio-group').forEach(group => {
      group.addEventListener('click', e => {
        const label = e.target.closest('.pill');
        if (!label) return;
        const input = label.querySelector('input[type="radio"]');
        if (!input) return;

        const name = input.name;
        document.querySelectorAll('input[name="' + name + '"]').forEach(r => {
          const l = r.closest('.pill');
          l.classList.remove('selected');
        });
        input.checked = true;
        label.classList.add('selected');
        saveLocalStorage(); // é¸æŠæ™‚ã‚‚ä¿å­˜
      });
    });

    // LocalStorageä¿å­˜ã®ãŸã‚ã®input/changeãƒªã‚¹ãƒŠãƒ¼
    document.querySelectorAll('input[data-local-save="true"], textarea, input[type="time"], input[type="number"]').forEach(el => {
        el.addEventListener('input', saveLocalStorage);
    });
    
    // åŸºæœ¬æƒ…å ±ã®å…¥åŠ›ãŒã‚ã£ãŸã‚‰ãƒ•ã‚©ãƒ¼ãƒ è¡¨ç¤ºã‚’æ›´æ–°
    document.getElementById('driverName').addEventListener('input', updateFormVisibility);
    document.getElementById('company').addEventListener('input', updateFormVisibility);

    // èµ°è¡Œè·é›¢ã®è‡ªå‹•è¨ˆç®—
    document.getElementById('returnMeter').addEventListener('input', () => {
        const start = parseFloat(document.getElementById('startMeter').value);
        const end = parseFloat(document.getElementById('returnMeter').value);
        const distanceEl = document.getElementById('distance');
        
        if (!isNaN(start) && !isNaN(end) && end >= start) {
            distanceEl.value = (end - start).toFixed(1);
        } else if (!isNaN(end) && start === 0) { // startMeterãŒæœªå…¥åŠ›ã®å ´åˆã®å¯¾å¿œ
             distanceEl.value = '';
        } else if (isNaN(end)) {
            distanceEl.value = '';
        }
        saveLocalStorage();
    });

    // -------------------------------------------------------------------
    // é€ä¿¡å‡¦ç†
    // -------------------------------------------------------------------

    function getRadioValue(name) {
      const r = document.querySelector('input[name="' + name + '"]:checked');
      return r ? r.value : '';
    }

    document.getElementById('submitBtn').addEventListener('click', async () => {
      const btn = document.getElementById('submitBtn');
      const status = document.getElementById('status');
      status.textContent = '';
      status.className = 'status-message';
      
      const isMorningMode = !sections.evening[0].classList.contains('hidden'); // å¤œã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ãŒè¡¨ç¤ºã•ã‚Œã¦ã„ãªã‘ã‚Œã°æœãƒ¢ãƒ¼ãƒ‰

      // å¿…é ˆãƒã‚§ãƒƒã‚¯é …ç›®ã‚’å®šç¾©
      const requiredIds = ['driverName', 'company', 'client', 'area', 'base', 'startPlace'];
      let requiredRadios = [];
      
      if (isMorningMode) {
          // æœãƒ¢ãƒ¼ãƒ‰ã®å¿…é ˆé …ç›®
          requiredIds.push('workTime', 'startTime', 'sleep', 'alcoholValue', 'startMeter');
          requiredRadios = ['condition', 'drink', 'medicine', 'check_brake', 'check_tire', 'check_light', 'check_camera', 'check_body', 'check_other'];
      } else {
          // å¤œãƒ¢ãƒ¼ãƒ‰ã®å¿…é ˆé …ç›®
          requiredIds.push('returnPlace', 'returnTime', 'returnMeter', 'rest', 'roadStatus');
          requiredRadios = ['codStatus'];
      }


      // 1. ãƒ†ã‚­ã‚¹ãƒˆ/æ™‚é–“/æ•°å€¤ã®å¿…é ˆãƒã‚§ãƒƒã‚¯
      for (const id of requiredIds) {
        const el = document.getElementById(id);
        if (el && !el.value.trim()) {
          status.textContent = 'æœªå…¥åŠ›ã®å¿…é ˆé …ç›®ãŒã‚ã‚Šã¾ã™ï¼š' + (el.previousElementSibling.textContent.split(' ')[0] || id);
          status.classList.add('status-error');
          el.focus();
          return;
        }
      }

      // 2. ãƒ©ã‚¸ã‚ªãƒœã‚¿ãƒ³ã®å¿…é ˆãƒã‚§ãƒƒã‚¯
      for (const name of requiredRadios) {
          if (!getRadioValue(name)) {
              const labelText = document.querySelector(`div[data-name="${name}"]`).previousElementSibling.textContent.split(' ')[0];
              status.textContent = 'æœªé¸æŠã®å¿…é ˆé …ç›®ãŒã‚ã‚Šã¾ã™ï¼š' + labelText;
              status.classList.add('status-error');
              return;
          }
      }

      btn.disabled = true;
      btn.innerHTML = '<span class="icon">â³</span><span>é€ä¿¡ä¸­ã§ã™â€¦</span>';

      const payload = {
        // åŸºæœ¬æƒ…å ± (ä¸¡ãƒ¢ãƒ¼ãƒ‰ã§é€ä¿¡)
        date: document.getElementById('date').value,
        driverName: document.getElementById('driverName').value.trim(),
        company: document.getElementById('company').value.trim(),
        client: document.getElementById('client').value.trim(),
        area: document.getElementById('area').value.trim(),
        base: document.getElementById('base').value.trim(),
        startPlace: document.getElementById('startPlace').value.trim(),
        email: document.getElementById('email').value.trim(),
        
        // ãƒ¢ãƒ¼ãƒ‰è­˜åˆ¥ç”¨
        mode: isMorningMode ? 'å‡ºç™ºç‚¹å‘¼' : 'å¸°åº«ç‚¹å‘¼', 
        
        // 02 å‡ºç™ºå‰å…¥åŠ› (æœãƒ¢ãƒ¼ãƒ‰ã§é€ä¿¡)
        workTime: document.getElementById('workTime').value,
        startTime: document.getElementById('startTime').value,
        condition: getRadioValue('condition'),
        sleep: document.getElementById('sleep').value,
        drink: getRadioValue('drink'),
        medicine: getRadioValue('medicine'),
        temp: document.getElementById('temp').value,
        alcoholValue: document.getElementById('alcoholValue').value,
        startMeter: document.getElementById('startMeter').value,
        memo: document.getElementById('memo').value,
        
        // 03 æ—¥å¸¸ç‚¹æ¤œ (æœãƒ¢ãƒ¼ãƒ‰ã§é€ä¿¡)
        check_brake: getRadioValue('check_brake'),
        check_tire: getRadioValue('check_tire'),
        check_light: getRadioValue('check_light'),
        check_camera: getRadioValue('check_camera'),
        check_body: getRadioValue('check_body'),
        check_other: getRadioValue('check_other'),
        check_note: document.getElementById('check_note').value,

        // 04 å¸°åº«å¾Œå…¥åŠ› (å¤œãƒ¢ãƒ¼ãƒ‰ã§é€ä¿¡)
        returnPlace: document.getElementById('returnPlace').value.trim(),
        returnTime: document.getElementById('returnTime').value,
        returnMeter: document.getElementById('returnMeter').value,
        distance: document.getElementById('distance').value,
        rest: document.getElementById('rest').value,
        codStatus: getRadioValue('codStatus'),
        codAmount: document.getElementById('codAmount').value,
        roadStatus: document.getElementById('roadStatus').value,
        abnormalDetail: document.getElementById('abnormalDetail').value
      };

      const formData = new FormData();
      formData.append('json', JSON.stringify(payload));
      
      // ãƒ•ã‚¡ã‚¤ãƒ«ã¯æœãƒ»å¤œãã‚Œãã‚Œã§ãƒã‚§ãƒƒã‚¯
      const licenseFile = document.getElementById('licenseFile').files[0];
      if (licenseFile && isMorningMode) {
        formData.append('licenseFile', licenseFile);
      }

      const carAbnormalFile = document.getElementById('carAbnormalFile').files[0];
      if (carAbnormalFile) {
        formData.append('carAbnormalFile', carAbnormalFile);
      }

      try {
        const response = await fetch(SCRIPT_URL, {
          method: 'POST',
          body: formData
        });
        
        if (!response.ok) {
            throw new Error('ã‚µãƒ¼ãƒãƒ¼ã‹ã‚‰ã®å¿œç­”ãŒã‚¨ãƒ©ãƒ¼ã§ã™');
        }

        status.textContent = (isMorningMode ? 'å‡ºç™ºç‚¹å‘¼' : 'å¸°åº«ç‚¹å‘¼ãƒ»æ—¥å ±') + 'ã‚’é€ä¿¡ã—ã¾ã—ãŸã€‚ãŠç–²ã‚Œæ§˜ã§ã—ãŸï¼';
        status.classList.add('status-success');
        
        // æˆåŠŸã—ãŸå ´åˆã€ãƒ•ã‚©ãƒ¼ãƒ ã‚’ãƒªã‚»ãƒƒãƒˆã—ã€è¡¨ç¤ºã‚’æ›´æ–°
        if (isMorningMode) {
             // æœç‚¹å‘¼æˆåŠŸå¾Œã¯ã€ãƒ•ã‚©ãƒ¼ãƒ ã‚’ã‚¯ãƒªã‚¢ã›ãšã«å¤œãƒ¢ãƒ¼ãƒ‰ã«ç§»è¡Œã™ã‚‹ãŸã‚ã«updateFormVisibilityã‚’å†å®Ÿè¡Œ
             await updateFormVisibility();
        } else {
             // å¤œç‚¹å‘¼æˆåŠŸå¾Œã¯ã€LocalStorageã¨ãƒ•ã‚©ãƒ¼ãƒ ã‚’ã‚¯ãƒªã‚¢
             localStorage.removeItem(LOCAL_STORAGE_KEY);
             localStorage.removeItem(LOCAL_STORAGE_DATE_KEY);
             document.querySelector('form') ? document.querySelector('form').reset() : location.reload();
        }


      } catch (err) {
        console.error(err);
        status.textContent = 'é€ä¿¡ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸã€‚é›»æ³¢çŠ¶æ³ã‚’ç¢ºèªã—ã¦ã€å†åº¦ãŠè©¦ã—ãã ã•ã„ã€‚';
        status.classList.add('status-error');
      } finally {
        btn.disabled = false;
        btn.innerHTML = `<span class="icon">${isMorningMode ? 'â˜€ï¸' : 'ğŸŒ™'}</span><span id="submitBtnText">${isMorningMode ? 'å‡ºç™ºç‚¹å‘¼ã‚’é€ä¿¡ã™ã‚‹' : 'å¸°åº«ç‚¹å‘¼ãƒ»æ—¥å ±ã‚’é€ä¿¡ã™ã‚‹'}</span>`;
        // ã‚¨ãƒ©ãƒ¼å¾Œã€ãƒœã‚¿ãƒ³ãƒ†ã‚­ã‚¹ãƒˆãŒå…ƒã®ãƒ¢ãƒ¼ãƒ‰ã«æˆ»ã‚‹ã‚ˆã†ã«å†è¨­å®š
        updateFormVisibility(); 
      }
    });

    // -------------------------------------------------------------------
    // ãƒšãƒ¼ã‚¸ãƒ­ãƒ¼ãƒ‰æ™‚ã®å®Ÿè¡Œ
    // -------------------------------------------------------------------
    (async function initialize() {
        setToday();
        loadLocalStorage();
        // åˆæœŸåŒ–å®Œäº†å¾Œã€éåŒæœŸã§ãƒ•ã‚©ãƒ¼ãƒ ã®è¡¨ç¤ºçŠ¶æ…‹ã‚’æ±ºå®š
        await updateFormVisibility();
    })();

  </script>
</body>
</html>
