<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>OFA｜出力（日報/月報/CSV）</title>
  <link rel="stylesheet" href="./style.css" />
  <script src="./config.js"></script>
  <script src="https://accounts.google.com/gsi/client" async defer></script>
</head>
<body data-page="export">
  <div class="wrap">
    <div class="header">
      <div class="brand">
        <div class="badge">OFA</div>
        <div>
          <h1>出力（日報PDF／月報PDF／CSV）</h1>
          <p>日報は詳細、月報は月間集計＋詳細行を出力</p>
        </div>
      </div>
    </div>

    <div class="grid">
      <div class="card col6">
        <div class="top"><div class="ttl">ログイン</div><div class="pill">本人のみ</div></div>
        <div class="body"><div id="loginBox"></div></div>
      </div>

      <div class="card col6">
        <div class="top"><div class="ttl">出力</div><div class="pill">Drive保存</div></div>
        <div class="body">
          <div class="row">
            <div>
              <label>日付（日報PDF）</label>
              <input id="dateDaily" type="date" />
            </div>
            <div>
              <label>月（YYYY-MM：月報/CSV/履歴）</label>
              <input id="month" type="month" />
            </div>
          </div>

          <div class="row">
            <button class="btn grad" id="btnDailyPdf" type="button">日報PDF（詳細）を作成</button>
          </div>
          <div class="row">
            <button class="btn" id="btnMonthlyPdf" type="button">月報PDF（詳細）を作成</button>
            <button class="btn" id="btnMonthlyCsv" type="button">月次CSVを作成</button>
          </div>

          <div class="hr"></div>
          <div class="pill">CSV（日付範囲）</div>
          <div class="row">
            <div><label>開始日</label><input id="fromDate" type="date"></div>
            <div><label>終了日</label><input id="toDate" type="date"></div>
          </div>
          <button class="btn dark" id="btnCsvRange" type="button">範囲CSVを作成</button>

          <div class="hr"></div>
          <div class="pill">日報PDF 履歴（対象月）</div>
          <div class="row">
            <div><label>履歴対象月</label><input id="historyMonth" type="month"></div>
            <div style="display:flex;align-items:flex-end;">
              <button class="btn small grad" id="btnLoadHistory" type="button" style="width:100%;">履歴を読み込む</button>
            </div>
          </div>

          <div class="card" id="historyBox" style="display:none; box-shadow:none; border-color:var(--line);">
            <div class="top">
              <div class="ttl">履歴</div><div class="pill" id="historyCount">0件</div>
            </div>
            <div class="body" id="historyList"></div>
          </div>

          <div class="card" id="resultBox" style="display:none; box-shadow:none; border-color:var(--line);"></div>

          <div class="note" style="margin-top:12px;">
            GAS: <span id="gasUrlView"></span>
          </div>

          <div style="height:10px"></div>
          <button class="btn" type="button" onclick="location.href='index.html'">戻る</button>
        </div>
      </div>
    </div>
  </div>

  <div class="toast" id="toast"></div>
  <script src="./auth.js"></script>
  <script src="./app.js"></script>
</body>
</html>
