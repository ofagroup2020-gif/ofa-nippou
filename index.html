<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>OFA 点呼・点検</title>
  <meta name="theme-color" content="#0b1b2a" />
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;600;700;900&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="./style.css" />
</head>
<body>
  <div class="bg"></div>

  <header class="top">
    <div class="brand">
      <div class="logo">🚚</div>
      <div>
        <div class="title">OFA 点呼・点検</div>
        <div class="subtitle">出発点呼 / 帰着点呼 / 日常点検（スマホ最適）</div>
      </div>
    </div>
  </header>

  <main class="wrap">
    <!-- Connection -->
    <section class="card">
      <div class="card-head">
        <div>
          <div class="card-title">接続設定</div>
          <div class="card-desc">※ここだけ正しければ動きます（端末に保存されます）</div>
        </div>
        <button class="btn btn-ghost" id="btnPing">接続テスト</button>
      </div>

      <label class="field">
        <div class="label">API URL（/exec）</div>
        <input id="apiUrl" class="input mono" placeholder="https://script.google.com/macros/s/XXXX/exec" />
        <div class="hint">
          保存→接続テストでOKになれば送信できます。<span class="kbd">/exec</span> まで含めて貼ってください。
        </div>
      </label>

      <div class="status" id="connStatus">
        <span class="dot dot-gray"></span>
        <div class="status-text">
          <div class="status-title">未確認</div>
          <div class="status-sub">接続テストを押してください</div>
        </div>
      </div>

      <div class="grid2 mt12">
        <button class="btn btn-soft" id="btnSaveUrl">API URL保存</button>
        <button class="btn btn-soft" id="btnClearUrl">URLクリア</button>
      </div>
    </section>

    <!-- Reports -->
    <section class="card">
      <div class="card-head">
        <div>
          <div class="card-title">帳票出力（PDF / CSV）</div>
          <div class="card-desc">日報・月報をDriveへ格納→リンク発行。CSVも出せます。</div>
        </div>
      </div>

      <div class="grid2 mt8">
        <div class="chip">
          <button class="btn btn-mini" id="btnDayPdf">日報PDF</button>
          <input class="input" type="date" id="dayDate" />
        </div>
        <div class="chip">
          <button class="btn btn-mini" id="btnMonthPdf">月報PDF</button>
          <input class="input" type="month" id="monthYm" />
        </div>
      </div>

      <div class="grid2 mt10">
        <div class="chip">
          <button class="btn btn-mini" id="btnDayCsv">日次CSV</button>
          <input class="input" type="date" id="dayCsvDate" />
        </div>
        <div class="chip">
          <button class="btn btn-mini" id="btnMonthCsv">月次CSV</button>
          <input class="input" type="month" id="monthCsvYm" />
        </div>
      </div>

      <div class="hint mt10">PDF/CSVは「氏名」で絞り込みできます（下の氏名が使われます）</div>
    </section>

    <!-- Mode -->
    <section class="card">
      <div class="card-head">
        <div>
          <div class="card-title">点呼モード</div>
          <div class="card-desc">出発と帰着で必須項目が変わります（法令テンプレ）</div>
        </div>
      </div>

      <div class="seg" role="tablist">
        <button class="seg-btn active" id="tabDepart" aria-selected="true">出発点呼</button>
        <button class="seg-btn" id="tabArrive" aria-selected="false">帰着点呼</button>
      </div>

      <!-- Basic -->
      <div class="section-title">基本情報</div>
      <div class="grid2">
        <label class="field">
          <div class="label req">氏名</div>
          <input id="driver" class="input" placeholder="例：山田 太郎" />
        </label>
        <label class="field">
          <div class="label req">車両番号</div>
          <input id="vehicle" class="input" placeholder="例：鹿児島480 あ 12-34" />
        </label>
      </div>

      <div class="grid2">
        <label class="field">
          <div class="label">電話（任意）</div>
          <input id="phone" class="input" placeholder="例：090-xxxx-xxxx" inputmode="tel" />
        </label>
        <label class="field">
          <div class="label">エリア（任意）</div>
          <input id="area" class="input" placeholder="例：鹿児島市 / 世田谷区" />
        </label>
      </div>

      <label class="field">
        <div class="label">ルート/コース（任意）</div>
        <input id="route" class="input" placeholder="例：Aコース / ○○便" />
      </label>

      <!-- Tenko -->
      <div class="section-title">点呼（健康・酒気帯び確認）</div>
      <div class="grid2">
        <label class="field">
          <div class="label req">アルコールチェック</div>
          <select id="alcohol" class="select">
            <option value="問題なし" selected>問題なし</option>
            <option value="反応あり（微量）">反応あり（微量）</option>
            <option value="反応あり（基準超え）">反応あり（基準超え）</option>
            <option value="未実施">未実施</option>
          </select>
        </label>
        <label class="field">
          <div class="label">数値（任意）</div>
          <input id="alcoholValue" class="input" placeholder="例：0.00" inputmode="decimal" />
        </label>
      </div>

      <div class="grid2">
        <label class="field">
          <div class="label req">体調</div>
          <select id="condition" class="select">
            <option value="良好" selected>良好</option>
            <option value="やや不良">やや不良</option>
            <option value="不良">不良</option>
          </select>
        </label>
        <label class="field">
          <div class="label">疲労度（任意）</div>
          <select id="fatigue" class="select">
            <option value="" selected>未入力</option>
            <option value="低い">低い</option>
            <option value="普通">普通</option>
            <option value="高い">高い</option>
          </select>
        </label>
      </div>

      <div class="grid2">
        <label class="field">
          <div class="label">体温（任意）</div>
          <input id="temp" class="input" placeholder="例：36.5" inputmode="decimal" />
        </label>
        <label class="field">
          <div class="label">睡眠時間（任意）</div>
          <input id="sleep" class="input" placeholder="例：7" inputmode="numeric" />
        </label>
      </div>

      <div class="grid2">
        <label class="field">
          <div class="label">服薬（任意）</div>
          <select id="medication" class="select">
            <option value="" selected>未入力</option>
            <option value="なし">なし</option>
            <option value="あり（眠気の可能性）">あり（眠気の可能性）</option>
            <option value="あり（問題なし）">あり（問題なし）</option>
          </select>
        </label>
        <label class="field">
          <div class="label">健康メモ（任意）</div>
          <input id="healthMemo" class="input" placeholder="例：頭痛あり/花粉症/通院後など" />
        </label>
      </div>

      <!-- Inspection -->
      <div class="section-title">日常点検（車両）</div>

      <label class="field">
        <div class="label req">日常点検（異常有無）</div>
        <select id="inspection" class="select">
          <option value="異常なし" selected>異常なし</option>
          <option value="異常あり">異常あり</option>
          <option value="未実施">未実施</option>
        </select>
        <div class="hint">異常ありの場合は「異常内容」を必須にします。</div>
      </label>

      <label class="field" id="inspectionDetailWrap">
        <div class="label">異常内容（異常ありの場合）</div>
        <input id="inspectionDetail" class="input" placeholder="例：左前輪 空気圧低下 / ブレーキ鳴き / 警告灯点灯など" />
      </label>

      <div class="grid2">
        <label class="field" id="meterStartWrap">
          <div class="label req" id="meterStartLabel">メーター（出発）</div>
          <input id="meterStart" class="input" placeholder="例：12345" inputmode="numeric" />
        </label>
        <label class="field" id="meterEndWrap">
          <div class="label req" id="meterEndLabel">メーター（帰着）</div>
          <input id="meterEnd" class="input" placeholder="例：23456" inputmode="numeric" />
        </label>
      </div>

      <!-- Photos -->
      <div class="section-title">写真（証跡）</div>
      <div class="hint">
        iPhoneで <b>HEIC</b> のままだと変換できずエラーになる場合があります。<br/>
        その場合は「写真を撮影→<b>互換性優先（JPEG）</b>」か、画像を<b>スクショ</b>してJPEGで選択してください。
      </div>

      <label class="field">
        <div class="label">点検写真（メーター/外観/警告灯など）</div>
        <input id="photoInspection" class="file" type="file" accept="image/*" />
      </label>

      <label class="field">
        <div class="label">アルコール検知器写真（任意）</div>
        <input id="photoAlcohol" class="file" type="file" accept="image/*" />
      </label>

      <label class="field">
        <div class="label">メーター写真（任意）</div>
        <input id="photoMeter" class="file" type="file" accept="image/*" />
      </label>

      <label class="field">
        <div class="label">その他写真（任意）</div>
        <input id="photoOther" class="file" type="file" accept="image/*" />
      </label>

      <!-- Memo -->
      <label class="field">
        <div class="label">備考（任意）</div>
        <textarea id="memo" class="textarea" rows="3" placeholder="連絡事項/遅延/クレーム/車両異常の詳細など"></textarea>
      </label>

      <button class="btn btn-main" id="btnSend">送信</button>

      <div class="toast" id="toast" aria-live="polite"></div>
    </section>

    <footer class="foot">
      © OFA Group / Tenko & Inspection
    </footer>
  </main>

  <script src="./app.js"></script>
</body>
</html>
