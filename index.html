<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>OFA 点呼・日報</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
body{font-family:-apple-system,BlinkMacSystemFont,sans-serif;background:#fff;color:#222;margin:0}
header{text-align:center;padding:16px;border-bottom:1px solid #eee}
header img{width:120px}
section{padding:16px}
h2{margin-top:28px;border-left:6px solid #1ecad3;padding-left:10px}
label{display:block;font-weight:bold;margin-top:14px}
input,select,textarea{width:100%;padding:10px;margin-top:6px;border:1px solid #ccc;border-radius:8px;font-size:16px}
textarea{min-height:80px}
button{margin-top:16px;padding:14px;width:100%;font-size:16px;border:none;border-radius:10px;color:#fff;
background:linear-gradient(90deg,#1ecad3,#8a5cff)}
.small{font-size:13px;color:#555}
.checklist{max-height:240px;overflow-y:auto;border:1px solid #ddd;padding:10px;border-radius:8px}
.list{border:1px solid #ddd;border-radius:8px;margin-top:10px}
.item{padding:10px;border-top:1px solid #eee;font-size:14px}
.item:first-child{border-top:none}
.gray{background:#f7f7f7;color:#000}
</style>
</head>

<body>

<header>
<img src="https://ofagroup2020-gif.github.io/logo.png">
</header>

<section>

<h2>① 基本情報（初回のみ）</h2>

<label>氏名*</label><input id="name">
<label>拠点*</label><input id="base">
<label>車両番号*</label><input id="car">
<label>免許証番号*</label><input id="license">
<label>電話番号*</label><input id="phone">
<label>メール*</label><input id="email">

<button onclick="saveProfile()">保存</button>

<hr>

<h2>② 点呼</h2>

<label>点呼区分*</label>
<select id="type">
<option value="">選択</option>
<option>出発</option>
<option>帰着</option>
</select>

<label>点呼日時*</label>
<input type="datetime-local" id="dt">

<label>睡眠時間 / 休憩時間*</label>
<input id="rest">

<label>体温*</label><input id="temp">
<label>体調*</label>
<select id="cond"><option></option><option>良好</option><option>注意</option><option>不良</option></select>

<label>出発ODO</label><input id="odoS">
<label>帰着ODO</label><input id="odoE">

<hr>

<h2>③ 日常点検</h2>
<div class="checklist">
<label><input type="checkbox"> タイヤ</label><br>
<label><input type="checkbox"> ブレーキ</label><br>
<label><input type="checkbox"> ライト</label><br>
<label><input type="checkbox"> ワイパー</label><br>
<label><input type="checkbox"> ミラー</label><br>
<label><input type="checkbox"> エンジン</label><br>
<label><input type="checkbox"> オイル</label><br>
<label><input type="checkbox"> 異常なし</label>
</div>

<label>特記事項</label><textarea id="memo"></textarea>

<button onclick="saveDaily()">履歴に保存</button>
<button onclick="makePDF()">PDF出力</button>

<hr>

<h2>④ 履歴</h2>
<div id="history" class="list"></div>

</section>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script>
function saveProfile(){
  const p={name:name.value,base:base.value,car:car.value,license:license.value,phone:phone.value,email:email.value};
  for(let k in p){ if(!p[k]) return alert("未入力あり"); }
  localStorage.setItem("ofa_profile",JSON.stringify(p));
  alert("保存しました");
}

function saveDaily(){
  const data={
    ...JSON.parse(localStorage.getItem("ofa_profile")||"{}"),
    type:type.value,dt:dt.value,rest:rest.value,temp:temp.value,cond:cond.value,
    odoS:odoS.value,odoE:odoE.value,memo:memo.value
  };
  if(!data.type||!data.dt) return alert("必須未入力");
  const list=JSON.parse(localStorage.getItem("ofa_daily")||"[]");
  list.push(data);
  localStorage.setItem("ofa_daily",JSON.stringify(list));
  loadHistory();
}

function loadHistory(){
  const box=document.getElementById("history");
  box.innerHTML="";
  const list=JSON.parse(localStorage.getItem("ofa_daily")||"[]");
  list.forEach(d=>{
    box.innerHTML+=`<div class="item">${d.dt} / ${d.type}</div>`;
  });
}
loadHistory();

function makePDF(){
  const {jsPDF}=window.jspdf;
  const pdf=new jsPDF();
  pdf.text("OFA 点呼・日報",10,15);
  pdf.text(`氏名:${name.value}`,10,30);
  pdf.text(`点呼:${type.value}`,10,38);
  pdf.text(`日時:${dt.value}`,10,46);
  pdf.save("ofa.pdf");
}
</script>
</body>
</html>
