<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <title>OFA GROUP 報酬計算ツール</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <style>
    * {
      box-sizing: border-box;
    }
    body {
      margin: 0;
      padding: 0;
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background: #f5f5f5;
      color: #222;
    }
    .ofa-header {
      background: linear-gradient(90deg, #ff3b30, #ffcc00, #007aff);
      padding: 14px 16px;
      color: #fff;
      font-weight: 900;
      font-size: 20px;
      letter-spacing: .06em;
      text-shadow: 0 1px 2px rgba(0,0,0,0.35);
    }
    .ofa-header small {
      display: block;
      font-size: 11px;
      font-weight: 500;
      margin-top: 4px;
    }

    .wrapper {
      max-width: 980px;
      margin: 0 auto;
      padding: 16px;
    }
    .card {
      background: #fff;
      border-radius: 14px;
      padding: 14px 14px 18px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.08);
      margin-bottom: 14px;
    }
    .card-title {
      font-weight: 700;
      margin-bottom: 10px;
      display: flex;
      align-items: center;
      gap: 6px;
    }
    .card-title span.tag {
      padding: 2px 8px;
      border-radius: 999px;
      font-size: 10px;
      background: #ffe565;
      color: #222;
      font-weight: 700;
    }

    label {
      font-size: 12px;
      font-weight: 600;
      display: block;
      margin-bottom: 4px;
    }
    .row-inline {
      display: flex;
      gap: 8px;
      flex-wrap: wrap;
    }
    .row-inline .field {
      flex: 1 1 0;
      min-width: 130px;
    }
    input[type="text"],
    input[type="number"],
    select {
      width: 100%;
      padding: 10px 11px;
      border-radius: 999px;
      border: 1px solid #ddd;
      font-size: 14px;
      outline: none;
      background: #fafafa;
    }
    input[type="number"]::-webkit-outer-spin-button,
    input[type="number"]::-webkit-inner-spin-button {
      -webkit-appearance: none;
      margin: 0;
    }

    .btn-row {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      margin-top: 8px;
    }
    .btn {
      border-radius: 999px;
      padding: 7px 14px;
      border: none;
      font-size: 13px;
      font-weight: 600;
      cursor: pointer;
      white-space: nowrap;
    }
    .btn-gray {
      background: #f1f1f1;
      color: #333;
    }
    .btn-black {
      background: #111;
      color: #fff;
    }
    .btn-yellow {
      background: #ffd400;
      color: #222;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 6px;
      font-size: 13px;
    }
    thead th {
      font-size: 11px;
      padding: 6px 4px;
      background: #ffee88;
      border-bottom: 1px solid #ffd400;
      position: sticky;
      top: 0;
      z-index: 1;
    }
    tbody td {
      padding: 6px 4px;
      border-bottom: 1px solid #f1f1f1;
    }
    tbody tr:nth-child(even) {
      background: #fcfcfc;
    }
    .col-kind { width: 40%; }
    .col-unit { width: 20%; }
    .col-qty  { width: 20%; }
    .col-sub  { width: 20%; text-align: right; }

    .chip {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      padding: 3px 9px;
      border-radius: 999px;
      font-size: 11px;
      font-weight: 600;
      background: #000;
      color: #fff;
      margin-right: 4px;
    }
    .total-box {
      margin-top: 10px;
      padding: 10px 12px;
      border-radius: 12px;
      background: #222;
      color: #fff;
      display: flex;
      align-items: baseline;
      justify-content: space-between;
      gap: 6px;
    }
    .total-box span.label {
      font-size: 12px;
      opacity: .85;
    }
    .total-box span.value {
      font-size: 20px;
      font-weight: 800;
    }

    .memo-input {
      width: 100%;
      min-height: 80px;
      border-radius: 12px;
      border: 1px solid #ddd;
      padding: 8px 10px;
      font-size: 13px;
      resize: vertical;
    }

    @media (max-width: 600px) {
      .ofa-header {
        font-size: 18px;
        padding: 12px 14px;
      }
      .card {
        padding: 12px 11px 14px;
      }
      thead th,
      tbody td {
        font-size: 12px;
      }
    }
  </style>
</head>
<body>
  <header class="ofa-header">
    OFA GROUP
    <small>報酬計算・日別売上チェック</small>
  </header>

  <main class="wrapper">

    <!-- ① 基本情報 -->
    <section class="card">
      <div class="card-title">
        <span class="tag">STEP 01</span>
        基本情報
      </div>
      <div class="row-inline">
        <div class="field">
          <label>エリア</label>
          <input type="text" id="areaInput" placeholder="例）鹿児島市伊敷" />
        </div>
        <div class="field">
          <label>取引先</label>
          <select id="clientSelect">
            <option value="">選択してください</option>
            <option value="ヤマト運輸">ヤマト運輸</option>
            <option value="佐川急便">佐川急便</option>
            <option value="日本郵便">日本郵便</option>
            <option value="Amazon">Amazon</option>
            <option value="その他">その他（単価は手入力）</option>
          </select>
        </div>
      </div>

      <div class="btn-row">
        <button class="btn btn-gray" id="btnLoadUnit">この取引先の単価を読み込む</button>
        <button class="btn btn-black" id="btnLoadAndCalc">単価読み込み計算する</button>
        <button class="btn btn-gray" id="btnToday">今日の日付にする</button>
      </div>
    </section>

    <!-- ② 荷物別 売上計算 -->
    <section class="card">
      <div class="card-title">
        <span class="tag">STEP 02</span>
        荷物種別ごとの内訳
      </div>

      <div style="overflow-x:auto;">
        <table>
          <thead>
            <tr>
              <th class="col-kind">荷物種別</th>
              <th class="col-unit">単価（円）</th>
              <th class="col-qty">数量</th>
              <th class="col-sub">小計（円）</th>
            </tr>
          </thead>
          <tbody id="itemsBody">
            <!-- JSで行定義しているのでIDで紐付け -->
          </tbody>
        </table>
      </div>

      <div class="total-box">
        <span class="label">この日の売上合計</span>
        <span class="value"><span id="totalSales">0</span> 円</span>
      </div>
    </section>

    <!-- ③ メモ -->
    <section class="card">
      <div class="card-title">
        <span class="tag">STEP 03</span>
        メモ（クレーム・遅延・事故・備考 など）
      </div>
      <textarea id="memo" class="memo-input"
        placeholder="例）◯◯様 再配達、××番地チャーター便 など"></textarea>
    </section>

  </main>

  <script>
    // ===============================
    //  取引先ごとの単価プリセット
    // ===============================
    const unitPricePresets = {
      "ヤマト運輸": {
        "一般荷物(宅配)": 165,
        "ポスティング": 45,
        "メール": 15,
        "一般集荷": 120,
        "代引き": 220,
        "チャーター便": 4400,
        "スポット便": 3300
      },
      "佐川急便": {
        "一般荷物(宅配)": 160,
        "ポスティング": 40,
        "メール": 15,
        "一般集荷": 110,
        "代引き": 200,
        "チャーター便": 4000,
        "スポット便": 3000
      },
      "日本郵便": {
        "一般荷物(宅配)": 155,
        "ポスティング": 42,
        "メール": 14,
        "一般集荷": 100,
        "代引き": 210,
        "チャーター便": 3800,
        "スポット便": 2800
      },
      "Amazon": {
        "一般荷物(宅配)": 170,
        "ポスティング": 50,
        "メール": 18,
        "一般集荷": 130,
        "代引き": 0,
        "チャーター便": 5000,
        "スポット便": 3500
      }
      // 必要に応じて、他の取引先もここに追加
    };

    // ===============================
    //  行の定義（並び順もここで決まる）
    // ===============================
    const itemDefinitions = [
      "一般荷物(宅配)",
      "ポスティング",
      "メール",
      "一般集荷",
      "代引き",
      "チャーター便",
      "スポット便"
    ];

    const itemsBody = document.getElementById("itemsBody");

    // テーブル行を生成
    itemDefinitions.forEach((name, index) => {
      const tr = document.createElement("tr");
      tr.innerHTML = `
        <td class="col-kind">
          <span class="chip">${index + 1}</span>${name}
        </td>
        <td class="col-unit">
          <input type="number" inputmode="decimal" min="0"
            id="unit_${index}" placeholder="単価" />
        </td>
        <td class="col-qty">
          <input type="number" inputmode="decimal" min="0"
            id="qty_${index}" placeholder="数量" />
        </td>
        <td class="col-sub">
          <span id="sub_${index}">0</span>
        </td>
      `;
      itemsBody.appendChild(tr);
    });

    // 単価・数量が変わったら自動で計算
    itemDefinitions.forEach((_, index) => {
      document.getElementById(`unit_${index}`).addEventListener("input", updateTotals);
      document.getElementById(`qty_${index}`).addEventListener("input", updateTotals);
    });

    // 今日ボタン（使いたければ、別で日付フィールドを追加してもOK）
    document.getElementById("btnToday").addEventListener("click", () => {
      alert("※日付フィールドはこのページにはまだ無いので、\n必要なら日付入力欄を追加して使ってください。");
    });

    // 「この取引先の単価を読み込む」
    document.getElementById("btnLoadUnit").addEventListener("click", () => {
      loadUnitPrices(false); // 計算はしない
    });

    // 「単価読み込み計算する」
    document.getElementById("btnLoadAndCalc").addEventListener("click", () => {
      const loaded = loadUnitPrices(true); // 読み込み＋計算
      if (!loaded) {
        // プリセットが無くても、手入力した単価で計算だけ行う
        updateTotals();
      }
    });

    /**
     * 取引先の単価を読み込む
     * @param {boolean} shouldCalc - 読み込んだあと計算まで行うか
     * @returns {boolean} 読み込めたら true / プリセット無しなら false
     */
    function loadUnitPrices(shouldCalc) {
      const clientSelect = document.getElementById("clientSelect");
      const client = clientSelect.value;

      if (!client) {
        alert("取引先を選択してください。");
        return false;
      }

      const preset = unitPricePresets[client];
      if (!preset) {
        alert("この取引先の単価プリセットはまだ登録されていません。\n単価は手入力してください。");
        return false;
      }

      itemDefinitions.forEach((name, index) => {
        const unitInput = document.getElementById(`unit_${index}`);
        unitInput.value = preset[name] != null ? preset[name] : "";
      });

      if (shouldCalc) {
        updateTotals();
      }
      return true;
    }

    /**
     * 合計計算
     */
    function updateTotals() {
      let total = 0;

      itemDefinitions.forEach((_, index) => {
        const unit = parseFloat(document.getElementById(`unit_${index}`).value) || 0;
        const qty  = parseFloat(document.getElementById(`qty_${index}`).value) || 0;
        const sub  = Math.round(unit * qty);

        document.getElementById(`sub_${index}`).textContent = sub.toLocaleString();
        total += sub;
      });

      document.getElementById("totalSales").textContent = total.toLocaleString();
    }
  </script>
</body>
</html>
