<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>OFA 点呼・点検</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;700;900&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="./style.css" />
</head>

<body>
  <div class="bg"></div>

  <header class="top">
    <div class="brand">
      <div class="logo">🚚</div>
      <div>
        <div class="title">OFA 点呼・点検</div>
        <div class="subtitle">出発点呼 / 帰着点呼 / 日常点検（スマホ最適）</div>
      </div>
    </div>
  </header>

  <main class="wrap">

    <!-- 接続 / 出力 -->
    <section class="card glass">
      <div class="cardHead">
        <div class="cardTitle">接続・出力</div>
        <button id="btnPing" class="btn primary">接続テスト</button>
      </div>

      <div class="grid2">
        <div class="field">
          <label>API URL（/exec）</label>
          <input id="apiUrl" type="url" placeholder="https://script.google.com/macros/s/XXXXX/exec" />
          <div class="hint">※ここが正しければ動きます（端末に保存されます）</div>
        </div>

        <div class="statusBox" id="statusBox">
          <div class="statusLine">
            <span class="dot gray" id="dot"></span>
            <span id="statusText">未確認（接続テストを押してください）</span>
          </div>
          <div class="statusMsg" id="statusMsg"> </div>
        </div>
      </div>

      <div class="divider"></div>

      <div class="grid2">
        <div class="field">
          <label>日報PDF（日付）</label>
          <div class="row">
            <input id="dailyDate" type="date" />
            <button id="btnDailyPdf" class="btn ghost">日報PDF</button>
          </div>
          <div class="hint">※氏名で絞り込み可能（下の氏名が使われます）</div>
        </div>

        <div class="field">
          <label>月報PDF（年月）</label>
          <div class="row">
            <input id="monthYm" type="month" />
            <button id="btnMonthlyPdf" class="btn ghost">月報PDF</button>
          </div>
          <div class="hint">※月次一覧CSVも出せます</div>
        </div>
      </div>

      <div class="row">
        <button id="btnMonthlyCsv" class="btn ghost">月次CSV（ダウンロード）</button>
      </div>

      <div id="linkArea" class="linkArea"></div>
    </section>

    <!-- モード -->
    <section class="card">
      <div class="tabs">
        <button class="tab on" data-mode="start" id="tabStart">出発点呼</button>
        <button class="tab" data-mode="end" id="tabEnd">帰着点呼</button>
      </div>

      <!-- 基本情報 -->
      <div class="section">
        <div class="sectionTitle">基本情報</div>

        <div class="grid2">
          <div class="field">
            <label>氏名 <span class="req">*</span></label>
            <input id="driver" type="text" placeholder="例：山田 太郎" />
          </div>
          <div class="field">
            <label>車両番号 <span class="req">*</span></label>
            <input id="vehicle" type="text" placeholder="例：鹿児島 480 あ 12-34" />
          </div>
        </div>

        <div class="grid2">
          <div class="field">
            <label>電話（任意）</label>
            <input id="phone" type="tel" placeholder="例：090-xxxx-xxxx" />
          </div>
          <div class="field">
            <label>エリア（任意）</label>
            <input id="area" type="text" placeholder="例：鹿児島市 / 世田谷区" />
          </div>
        </div>

        <div class="field">
          <label>ルート/コース（任意）</label>
          <input id="route" type="text" placeholder="例：Aコース / ○○便" />
        </div>
      </div>

      <!-- 点呼（法令テンプレ） -->
      <div class="section tint">
        <div class="sectionTitle">点呼（健康・酒気帯び確認）</div>

        <div class="grid2">
          <div class="field">
            <label>アルコールチェック <span class="req">*</span></label>
            <select id="alcohol">
              <option value="問題なし" selected>問題なし</option>
              <option value="未実施">未実施</option>
              <option value="検知あり">検知あり</option>
              <option value="判定不能">判定不能</option>
            </select>
          </div>
          <div class="field">
            <label>数値（任意）</label>
            <input id="alcoholValue" type="number" step="0.01" placeholder="例：0.00" />
          </div>
        </div>

        <div class="grid2">
          <div class="field">
            <label>体調 <span class="req">*</span></label>
            <select id="condition">
              <option value="良好" selected>良好</option>
              <option value="やや不良">やや不良</option>
              <option value="不良">不良</option>
            </select>
          </div>

          <div class="field">
            <label>疲労度（任意）</label>
            <select id="fatigue">
              <option value="">未入力</option>
              <option value="低い">低い</option>
              <option value="普通">普通</option>
              <option value="高い">高い</option>
            </select>
          </div>
        </div>

        <div class="grid2">
          <div class="field">
            <label>体温（任意）</label>
            <input id="temp" type="number" step="0.1" placeholder="例：36.5" />
          </div>
          <div class="field">
            <label>睡眠時間（任意）</label>
            <input id="sleep" type="number" step="0.5" placeholder="例：7" />
          </div>
        </div>

        <div class="grid2">
          <div class="field">
            <label>服薬（任意）</label>
            <select id="medicine">
              <option value="">未入力</option>
              <option value="なし">なし</option>
              <option value="あり（眠気の恐れなし）">あり（眠気の恐れなし）</option>
              <option value="あり（眠気の恐れあり）">あり（眠気の恐れあり）</option>
            </select>
          </div>
          <div class="field">
            <label>健康メモ（任意）</label>
            <input id="healthMemo" type="text" placeholder="例：頭痛あり / 花粉症 / 眠気" />
          </div>
        </div>

        <!-- 帰着専用 -->
        <div class="field onlyEnd">
          <label>運行メモ（帰着・任意）</label>
          <input id="runMemo" type="text" placeholder="例：渋滞・遅延・クレーム・ヒヤリハット等" />
        </div>
      </div>

      <!-- 点検（法令テンプレ） -->
      <div class="section">
        <div class="sectionTitle">日常点検（車両）</div>

        <div class="grid2">
          <div class="field">
            <label>日常点検（異常有無） <span class="req">*</span></label>
            <select id="inspection">
              <option value="異常なし" selected>異常なし</option>
              <option value="異常あり">異常あり</option>
              <option value="未実施">未実施</option>
            </select>
          </div>

          <div class="field">
            <label>異常内容（異常ありの場合）</label>
            <input id="inspectionDetail" type="text" placeholder="例：左前輪 空気圧低下 / ブレーキ鳴き 等" />
          </div>
        </div>

        <!-- メーター：モードで必須を切替 -->
        <div class="grid2">
          <div class="field onlyStart">
            <label>メーター（出発） <span class="req">*</span></label>
            <input id="meterStart" type="number" placeholder="例：12345" />
          </div>
          <div class="field onlyEnd">
            <label>メーター（帰着） <span class="req">*</span></label>
            <input id="meterEnd" type="number" placeholder="例：23456" />
          </div>
        </div>

        <!-- 点検チェック（増量） -->
        <div class="checkGrid">
          <label class="check"><input type="checkbox" id="chkTire"> タイヤ（空気圧/亀裂/溝）</label>
          <label class="check"><input type="checkbox" id="chkBrake"> ブレーキ（効き/異音）</label>
          <label class="check"><input type="checkbox" id="chkLight"> 灯火類（ヘッド/ウインカー/ハザード）</label>
          <label class="check"><input type="checkbox" id="chkOil"> 油脂類（エンジン油/漏れ）</label>
          <label class="check"><input type="checkbox" id="chkCoolant"> 冷却水</label>
          <label class="check"><input type="checkbox" id="chkWiper"> ワイパー/ウォッシャー</label>
          <label class="check"><input type="checkbox" id="chkHorn"> 警音器（ホーン）</label>
          <label class="check"><input type="checkbox" id="chkMirror"> ミラー/視界</label>
          <label class="check"><input type="checkbox" id="chkLoad"> 荷崩れ防止/積載状態</label>
          <label class="check"><input type="checkbox" id="chkWarning"> 警告灯/メーター表示</label>
        </div>

        <!-- 写真 -->
        <div class="section soft">
          <div class="sectionTitle">写真（任意）</div>

          <div class="grid2">
            <div class="field">
              <label>点検写真（メーター/外観/警告灯など）</label>
              <input id="photoInspection" type="file" accept="image/*" />
              <div class="hint">※iPhoneのHEICは変換できずエラーになる場合あり（その場合JPEGで選択）</div>
            </div>
            <div class="field">
              <label>アルコール検知器写真</label>
              <input id="photoAlcohol" type="file" accept="image/*" />
            </div>
          </div>

          <div class="grid2">
            <div class="field">
              <label>メーター写真</label>
              <input id="photoMeter" type="file" accept="image/*" />
            </div>
            <div class="field">
              <label>その他写真（任意）</label>
              <input id="photoOther" type="file" accept="image/*" multiple />
            </div>
          </div>

          <div class="field">
            <label>備考（任意）</label>
            <textarea id="memo" rows="3" placeholder="連絡事項 / 遅延 / クレーム / 車両異常の詳細など"></textarea>
          </div>
        </div>

      </div>

      <div class="footerBar">
        <button id="btnSubmit" class="btn big primary">送信</button>
        <div id="submitMsg" class="submitMsg"></div>
      </div>

    </section>

    <footer class="foot">© OFA Group / Tenko & Inspection</footer>
  </main>

  <script src="./app.js"></script>
</body>
</html>
