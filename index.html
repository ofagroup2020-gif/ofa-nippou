<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>OFA ç‚¹å‘¼ãƒ»ç‚¹æ¤œ</title>

<style>
body {
  font-family: -apple-system, BlinkMacSystemFont, "Helvetica Neue", sans-serif;
  background: #f4f6f8;
  margin: 0;
}
.container {
  max-width: 520px;
  margin: 0 auto;
  padding: 16px;
}
h1 {
  font-size: 20px;
  margin-bottom: 16px;
}
label {
  display: block;
  margin-top: 14px;
  font-weight: 600;
}
select, input, textarea, button {
  width: 100%;
  margin-top: 6px;
  padding: 12px;
  font-size: 16px;
  border-radius: 8px;
  border: 1px solid #ccc;
}
textarea {
  min-height: 80px;
}
button {
  margin-top: 20px;
  background: #1a73e8;
  color: #fff;
  border: none;
  font-size: 18px;
}
.hidden {
  display: none;
}
.success {
  margin-top: 12px;
  color: green;
  font-weight: bold;
}
</style>
</head>

<body>
<div class="container">
  <h1>ğŸšš OFA ç‚¹å‘¼ãƒ»ç‚¹æ¤œ</h1>

  <label>ç‚¹å‘¼ç¨®åˆ¥</label>
  <select id="type" onchange="toggleFields()">
    <option value="å‡ºç™ºç‚¹å‘¼">å‡ºç™ºç‚¹å‘¼</option>
    <option value="å¸°ç€ç‚¹å‘¼">å¸°ç€ç‚¹å‘¼</option>
  </select>

  <label>æ°å</label>
  <input id="name" placeholder="ä¾‹ï¼šæ£®ä¸‹ æ´¸">

  <label>è»Šä¸¡ç•ªå·</label>
  <input id="car" placeholder="ä¾‹ï¼šé¹¿å…å³¶400 ã‚ 12-34">

  <!-- å‡ºç™ºç‚¹å‘¼ -->
  <div id="startFields">
    <label>ã‚¢ãƒ«ã‚³ãƒ¼ãƒ«ãƒã‚§ãƒƒã‚¯</label>
    <select id="alcoholStart">
      <option>å•é¡Œãªã—</option>
      <option>æ¤œçŸ¥ã‚ã‚Š</option>
    </select>

    <label>ä½“èª¿</label>
    <select id="condition">
      <option>è‰¯å¥½</option>
      <option>ã‚„ã‚„ä¸èª¿</option>
      <option>ä¸èª¿</option>
    </select>
  </div>

  <!-- å¸°ç€ç‚¹å‘¼ -->
  <div id="endFields" class="hidden">
    <label>æ¥­å‹™çµ‚äº†æ™‚ã‚¢ãƒ«ã‚³ãƒ¼ãƒ«</label>
    <select id="alcoholEnd">
      <option>å•é¡Œãªã—</option>
      <option>æ¤œçŸ¥ã‚ã‚Š</option>
    </select>

    <label>æ—¥å¸¸ç‚¹æ¤œï¼ˆç•°å¸¸æœ‰ç„¡ï¼‰</label>
    <select id="inspection">
      <option>ç•°å¸¸ãªã—</option>
      <option>ç•°å¸¸ã‚ã‚Š</option>
    </select>
  </div>

  <label>å‚™è€ƒ</label>
  <textarea id="memo"></textarea>

  <button onclick="submitForm()">é€ä¿¡</button>

  <div id="result" class="success hidden">âœ… é€ä¿¡ã—ã¾ã—ãŸ</div>
</div>

<script>
const GAS_URL = "https://script.google.com/macros/s/AKfycbzlmxyYmEL7Kb6jzr903woXuMuEdck8q_jjHgPyA3q4RzNAKh1QqHs9WNSroBNXcwAPzA/exec";

function toggleFields() {
  const type = document.getElementById("type").value;
  document.getElementById("startFields").classList.toggle("hidden", type !== "å‡ºç™ºç‚¹å‘¼");
  document.getElementById("endFields").classList.toggle("hidden", type !== "å¸°ç€ç‚¹å‘¼");
}

function submitForm() {
  const data = {
    type: type.value,
    name: name.value,
    car: car.value,
    alcoholStart: alcoholStart?.value || "",
    condition: condition?.value || "",
    alcoholEnd: alcoholEnd?.value || "",
    inspection: inspection?.value || "",
    memo: memo.value
  };

  fetch(GAS_URL, {
    method: "POST",
    body: JSON.stringify(data),
    headers: { "Content-Type": "application/json" }
  }).then(() => {
    document.getElementById("result").classList.remove("hidden");
  });
}
</script>
</body>
</html>
