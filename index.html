<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>OFA ç‚¹å‘¼ãƒ»ç‚¹æ¤œ</title>
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto;
      background: #f4f6f8;
      margin: 0;
      padding: 16px;
    }
    h1 {
      font-size: 20px;
      margin-bottom: 8px;
    }
    .card {
      background: #fff;
      border-radius: 10px;
      padding: 16px;
      margin-bottom: 16px;
    }
    label {
      display: block;
      margin-top: 12px;
      font-weight: 600;
    }
    input, select, textarea, button {
      width: 100%;
      padding: 10px;
      margin-top: 4px;
      font-size: 16px;
    }
    button {
      background: #1a73e8;
      color: #fff;
      border: none;
      border-radius: 8px;
      margin-top: 16px;
    }
    .ok { color: green; }
    .ng { color: red; }
  </style>
</head>
<body>

<h1>ğŸšš OFA ç‚¹å‘¼ãƒ»ç‚¹æ¤œ</h1>

<div class="card">
  <button onclick="testConnection()">æ¥ç¶šãƒ†ã‚¹ãƒˆ</button>
  <div id="status"></div>
</div>

<div class="card">
  <form id="form">
    <label>ç‚¹å‘¼ç¨®åˆ¥</label>
    <select name="type">
      <option value="å‡ºç™º">å‡ºç™ºç‚¹å‘¼</option>
      <option value="å¸°ç€">å¸°ç€ç‚¹å‘¼</option>
    </select>

    <label>æ°å</label>
    <input name="driver" required>

    <label>è»Šä¸¡ç•ªå·</label>
    <input name="vehicle" required>

    <label>ã‚¢ãƒ«ã‚³ãƒ¼ãƒ«ãƒã‚§ãƒƒã‚¯</label>
    <select name="alcohol">
      <option value="å•é¡Œãªã—">å•é¡Œãªã—</option>
      <option value="ç•°å¸¸ã‚ã‚Š">ç•°å¸¸ã‚ã‚Š</option>
    </select>

    <label>ä½“èª¿</label>
    <select name="condition">
      <option value="è‰¯å¥½">è‰¯å¥½</option>
      <option value="ä¸è‰¯">ä¸è‰¯</option>
    </select>

    <label>ä½“æ¸©ï¼ˆä»»æ„ï¼‰</label>
    <input name="temp">

    <label>ç¡çœ æ™‚é–“ï¼ˆä»»æ„ï¼‰</label>
    <input name="sleep">

    <label>ãƒ¡ãƒ¼ã‚¿ãƒ¼ï¼ˆå‡ºç™º/å¸°ç€ï¼‰</label>
    <input name="meter">

    <label>å‚™è€ƒ</label>
    <textarea name="memo"></textarea>

    <button type="submit">é€ä¿¡</button>
    <div id="result"></div>
  </form>
</div>

<script>
const GAS_URL =
  "https://script.google.com/macros/s/AKfycbzoEn9NU_ejtAwjwYz4K5ahrVo5Usl_4KH22BvUV8-YFgsxAa8BAMOBZ3U2IudVSHsyvw/exec";

function testConnection() {
  fetch(GAS_URL)
    .then(r => r.text())
    .then(() => {
      document.getElementById("status").innerHTML =
        "<span class='ok'>âœ” æ¥ç¶šOK</span>";
    })
    .catch(() => {
      document.getElementById("status").innerHTML =
        "<span class='ng'>âœ– æ¥ç¶šNG</span>";
    });
}

document.getElementById("form").addEventListener("submit", e => {
  e.preventDefault();

  const data = Object.fromEntries(new FormData(e.target).entries());

  fetch(GAS_URL, {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify(data)
  })
  .then(r => r.json())
  .then(() => {
    document.getElementById("result").innerHTML =
      "<span class='ok'>âœ” é€ä¿¡å®Œäº†</span>";
    e.target.reset();
  })
  .catch(() => {
    document.getElementById("result").innerHTML =
      "<span class='ng'>âœ– é€ä¿¡å¤±æ•—</span>";
  });
});
</script>

</body>
</html>
