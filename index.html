<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>OFA 点呼システム（完全版）</title>
  <link rel="stylesheet" href="./style.css" />
</head>
<body>
  <div class="wrap">
    <header class="topbar">
      <div class="brand">
        <div class="logo">OFA</div>
        <div>
          <div class="title">OFA 点呼システム</div>
          <div class="subtitle">出発点呼 / 帰着点呼・日報 / PDF / 月報CSV（Drive保存）</div>
        </div>
      </div>
      <div class="right">
        <span id="badge" class="badge">未ログイン</span>
        <button id="btnLogout" class="btn ghost" type="button">ログアウト</button>
      </div>
    </header>

    <section class="card rainbow-border">
      <h2 class="h2">点呼の重要ルール（必読）</h2>
      <ul class="ul">
        <li>点呼は「業務開始前（出発）」と「業務終了後（帰着）」の2回</li>
        <li>アルコールチェックは必須（数値 + 酒気帯び判定）</li>
        <li>免許証番号は必須（写真は任意）</li>
        <li>日常点検（車両点検）は必須（NG時は異常写真推奨）</li>
        <li>帰着点呼は日報PDF提出のため丁寧に記載</li>
      </ul>
    </section>

    <!-- LOGIN -->
    <section id="viewLogin" class="card rainbow-border">
      <h2 class="h2">ログイン（パスワード）</h2>
      <p class="hint">
        パスワードは <a href="https://lin.ee/8dsZjAo" target="_blank" rel="noopener">OFAメンバーLINE公式</a> で通知します（定期更新）。<br>
        ※ページ上にパスワードを表示しません。
      </p>

      <div class="grid grid2">
        <div>
          <label>パスワード <span class="req">*</span></label>
          <input id="loginPass" type="password" placeholder="パスワードを入力" />
        </div>
        <div class="loginBtns">
          <button class="btn rainbow" id="btnLoginDriver" type="button">ドライバーでログイン</button>
          <button class="btn dark" id="btnLoginAdmin" type="button">管理者でログイン</button>
        </div>
      </div>
      <small class="hint">※ログイン後に各ページへ進めます。</small>
    </section>

    <!-- MENU -->
    <section id="viewMenu" class="card rainbow-border hidden">
      <h2 class="h2">メニュー</h2>
      <div class="btnrow">
        <button class="btn light" id="goDeparture" type="button">出発点呼</button>
        <button class="btn light" id="goArrival" type="button">帰着点呼・日報</button>
        <button class="btn dark" id="goMyExport" type="button">自分：PDF / 月報CSV</button>
        <button class="btn dark" id="goAdmin" type="button">管理者：検索 / 出力</button>
      </div>
      <small class="hint">※管理者メニューは管理者ログイン時のみ表示されます。</small>
    </section>

    <!-- DEPARTURE -->
    <section id="viewDeparture" class="card rainbow-border hidden">
      <div class="sectionTop">
        <h2 class="h2">出発点呼（業務開始前）</h2>
        <button class="btn ghost" id="backFromDeparture" type="button">戻る</button>
      </div>

      <div class="grid grid2">
        <div><label>日付 <span class="req">*</span></label><input id="dep_date" type="date"></div>
        <div><label>時刻 <span class="req">*</span></label><input id="dep_time" type="time"></div>
      </div>

      <div class="grid grid2">
        <div><label>運転者氏名（本名） <span class="req">*</span></label><input id="dep_driverName" type="text" placeholder="例：森下 洸"></div>
        <div><label>電話番号（任意：検索用）</label><input id="dep_driverPhone" type="tel" placeholder="080..."></div>
      </div>

      <div class="grid grid2">
        <div><label>車両番号/ナンバー <span class="req">*</span></label><input id="dep_vehicleNo" type="text" placeholder="例：鹿児島 480 れ 21-15"></div>
        <div><label>点呼実施者 <span class="req">*</span></label><input id="dep_managerName" type="text" placeholder="例：太田"></div>
      </div>

      <div class="grid grid2">
        <div>
          <label>点呼方法 <span class="req">*</span></label>
          <select id="dep_method">
            <option value="">選択</option>
            <option>対面</option><option>電話</option><option>ビデオ通話</option><option>チャット</option>
          </select>
        </div>
        <div><label>点呼場所 <span class="req">*</span></label><input id="dep_place" type="text" placeholder="例：Amazon鹿児島"></div>
      </div>

      <hr class="sep">
      <h3 class="h3">日常点呼（法令項目）</h3>

      <div class="grid grid3">
        <div><label>睡眠時間（h） <span class="req">*</span></label><input id="dep_sleepHours" type="number" step="0.5" min="0" max="24" placeholder="例：6.0"></div>
        <div>
          <label>体調 <span class="req">*</span></label>
          <select id="dep_condition">
            <option value="">選択</option><option>良好</option><option>普通</option><option>不良</option>
          </select>
        </div>
        <div>
          <label>疲労/眠気 <span class="req">*</span></label>
          <select id="dep_fatigue">
            <option value="">選択</option><option>なし</option><option>軽度</option><option>強い</option>
          </select>
        </div>
      </div>

      <div class="grid grid3">
        <div>
          <label>服薬/飲酒の恐れ <span class="req">*</span></label>
          <select id="dep_medication">
            <option value="">選択</option><option>なし</option><option>あり</option>
          </select>
        </div>
        <div>
          <label>発熱/体温 <span class="req">*</span></label>
          <input id="dep_temp" type="text" placeholder="例：36.5">
        </div>
        <div>
          <label>注意事項（指示） <span class="req">*</span></label>
          <select id="dep_notice">
            <option value="">選択</option><option>特になし</option><option>あり</option>
          </select>
        </div>
      </div>

      <hr class="sep">
      <h3 class="h3">アルコール（必須）</h3>
      <div class="grid grid2">
        <div><label>アルコール数値（mg/L等） <span class="req">*</span></label><input id="dep_alcoholValue" type="text" placeholder="例：0.00"></div>
        <div>
          <label>酒気帯び判定 <span class="req">*</span></label>
          <select id="dep_alcoholBand">
            <option value="">選択</option><option>なし</option><option>あり</option>
          </select>
        </div>
      </div>
      <div class="grid grid2">
        <div><label>アルコールチェック写真（任意）</label><input id="dep_alcoholPhoto" type="file" accept="image/*"></div>
        <div><label>点呼写真（任意）</label><input id="dep_tenkoPhoto" type="file" accept="image/*"></div>
      </div>

      <hr class="sep">
      <h3 class="h3">免許（番号必須 / 写真任意）</h3>
      <div class="grid grid2">
        <div><label>免許証番号 <span class="req">*</span></label><input id="dep_licenseNo" type="text" placeholder="番号を入力"></div>
        <div><label>免許写真（任意）</label><input id="dep_licensePhoto" type="file" accept="image/*"></div>
      </div>

      <hr class="sep">
      <h3 class="h3">走行メーター</h3>
      <div class="grid grid2">
        <div><label>開始メーター</label><input id="dep_odoStart" inputmode="numeric" placeholder="例：12345"></div>
        <div><label>備考</label><input id="dep_memo" type="text" placeholder="異常や注意事項があれば記載"></div>
      </div>

      <hr class="sep">
      <h3 class="h3">日常点検（必須）</h3>
      <div class="grid grid3">
        <div><label>タイヤ <span class="req">*</span></label><select id="dep_insp_tire"><option value="">選択</option><option>OK</option><option>NG</option></select></div>
        <div><label>灯火 <span class="req">*</span></label><select id="dep_insp_light"><option value="">選択</option><option>OK</option><option>NG</option></select></div>
        <div><label>ブレーキ <span class="req">*</span></label><select id="dep_insp_brake"><option value="">選択</option><option>OK</option><option>NG</option></select></div>

        <div><label>ワイパー <span class="req">*</span></label><select id="dep_insp_wiper"><option value="">選択</option><option>OK</option><option>NG</option></select></div>
        <div><label>エンジンオイル <span class="req">*</span></label><select id="dep_insp_engineOil"><option value="">選択</option><option>OK</option><option>NG</option></select></div>
        <div><label>冷却水 <span class="req">*</span></label><select id="dep_insp_coolant"><option value="">選択</option><option>OK</option><option>NG</option></select></div>

        <div><label>バッテリー <span class="req">*</span></label><select id="dep_insp_battery"><option value="">選択</option><option>OK</option><option>NG</option></select></div>
        <div><label>ホーン <span class="req">*</span></label><select id="dep_insp_horn"><option value="">選択</option><option>OK</option><option>NG</option></select></div>
        <div><label>ミラー <span class="req">*</span></label><select id="dep_insp_mirror"><option value="">選択</option><option>OK</option><option>NG</option></select></div>

        <div><label>外装/破損 <span class="req">*</span></label><select id="dep_insp_damage"><option value="">選択</option><option>OK</option><option>NG</option></select></div>
        <div><label>積載状態 <span class="req">*</span></label><select id="dep_insp_cargo"><option value="">選択</option><option>OK</option><option>NG</option></select></div>
        <div><label>消火器 <span class="req">*</span></label><select id="dep_insp_ext"><option value="">選択</option><option>OK</option><option>NG</option></select></div>

        <div><label>三角停止板 <span class="req">*</span></label><select id="dep_insp_triangle"><option value="">選択</option><option>OK</option><option>NG</option></select></div>
        <div><label>工具/安全備品 <span class="req">*</span></label><select id="dep_insp_tools"><option value="">選択</option><option>OK</option><option>NG</option></select></div>
        <div><label>その他異常 <span class="req">*</span></label><select id="dep_insp_other"><option value="">選択</option><option>なし</option><option>あり</option></select></div>
      </div>

      <label>点検メモ（任意：NG/異常は必ず詳細）</label>
      <textarea id="dep_insp_note" placeholder="NG/異常の詳細を記載"></textarea>

      <label>異常箇所写真（任意：NG時推奨）</label>
      <input id="dep_abnormalPhoto" type="file" accept="image/*">

      <div class="btnrow">
        <button class="btn rainbow" id="btnSubmitDeparture" type="button">送信（出発点呼）</button>
      </div>
      <small class="hint">※送信後：スプレッドシート保存＋写真はDrive保存（リンク保持）</small>
    </section>

    <!-- ARRIVAL -->
    <section id="viewArrival" class="card rainbow-border hidden">
      <div class="sectionTop">
        <h2 class="h2">帰着点呼（業務終了）・日報</h2>
        <button class="btn ghost" id="backFromArrival" type="button">戻る</button>
      </div>

      <div class="grid grid2">
        <div><label>日付 <span class="req">*</span></label><input id="arr_date" type="date"></div>
        <div><label>時刻 <span class="req">*</span></label><input id="arr_time" type="time"></div>
      </div>

      <div class="grid grid2">
        <div><label>運転者氏名（本名） <span class="req">*</span></label><input id="arr_driverName" type="text" placeholder="例：森下 洸"></div>
        <div><label>電話番号（任意：検索用）</label><input id="arr_driverPhone" type="tel" placeholder="080..."></div>
      </div>

      <div class="grid grid2">
        <div><label>車両番号/ナンバー <span class="req">*</span></label><input id="arr_vehicleNo" type="text" placeholder="例：鹿児島 480 れ 21-15"></div>
        <div><label>点呼実施者 <span class="req">*</span></label><input id="arr_managerName" type="text" placeholder="例：太田"></div>
      </div>

      <div class="grid grid2">
        <div>
          <label>点呼方法 <span class="req">*</span></label>
          <select id="arr_method">
            <option value="">選択</option>
            <option>対面</option><option>電話</option><option>ビデオ通話</option><option>チャット</option>
          </select>
        </div>
        <div><label>点呼場所 <span class="req">*</span></label><input id="arr_place" type="text" placeholder="例：Amazon鹿児島"></div>
      </div>

      <hr class="sep">
      <h3 class="h3">日常点呼（法令項目）</h3>
      <div class="grid grid3">
        <div><label>休憩時間（h） <span class="req">*</span></label><input id="arr_restHours" type="number" step="0.5" min="0" max="24" placeholder="例：1.5"></div>
        <div>
          <label>体調 <span class="req">*</span></label>
          <select id="arr_condition">
            <option value="">選択</option><option>良好</option><option>普通</option><option>不良</option>
          </select>
        </div>
        <div>
          <label>疲労/眠気 <span class="req">*</span></label>
          <select id="arr_fatigue">
            <option value="">選択</option><option>なし</option><option>軽度</option><option>強い</option>
          </select>
        </div>
      </div>

      <hr class="sep">
      <h3 class="h3">アルコール（必須）</h3>
      <div class="grid grid2">
        <div><label>アルコール数値（mg/L等） <span class="req">*</span></label><input id="arr_alcoholValue" type="text" placeholder="例：0.00"></div>
        <div>
          <label>酒気帯び判定 <span class="req">*</span></label>
          <select id="arr_alcoholBand">
            <option value="">選択</option><option>なし</option><option>あり</option>
          </select>
        </div>
      </div>
      <div class="grid grid2">
        <div><label>アルコールチェック写真（任意）</label><input id="arr_alcoholPhoto" type="file" accept="image/*"></div>
        <div><label>点呼写真（任意）</label><input id="arr_tenkoPhoto" type="file" accept="image/*"></div>
      </div>

      <hr class="sep">
      <h3 class="h3">免許（番号必須 / 写真任意）</h3>
      <div class="grid grid2">
        <div><label>免許証番号 <span class="req">*</span></label><input id="arr_licenseNo" type="text" placeholder="番号を入力"></div>
        <div><label>免許写真（任意）</label><input id="arr_licensePhoto" type="file" accept="image/*"></div>
      </div>

      <hr class="sep">
      <h3 class="h3">走行メーター</h3>
      <div class="grid grid3">
        <div><label>開始メーター（出発の値でもOK）</label><input id="arr_odoStart" inputmode="numeric" placeholder="例：12345"></div>
        <div><label>終了メーター（帰着）</label><input id="arr_odoEnd" inputmode="numeric" placeholder="例：12500"></div>
        <div><label>走行距離（自動）</label><input id="arr_odoTotal" readonly placeholder="自動計算"></div>
      </div>

      <hr class="sep">
      <h3 class="h3">日常点検（必須）</h3>
      <div class="grid grid3">
        <div><label>タイヤ <span class="req">*</span></label><select id="arr_insp_tire"><option value="">選択</option><option>OK</option><option>NG</option></select></div>
        <div><label>灯火 <span class="req">*</span></label><select id="arr_insp_light"><option value="">選択</option><option>OK</option><option>NG</option></select></div>
        <div><label>ブレーキ <span class="req">*</span></label><select id="arr_insp_brake"><option value="">選択</option><option>OK</option><option>NG</option></select></div>

        <div><label>ワイパー <span class="req">*</span></label><select id="arr_insp_wiper"><option value="">選択</option><option>OK</option><option>NG</option></select></div>
        <div><label>エンジンオイル <span class="req">*</span></label><select id="arr_insp_engineOil"><option value="">選択</option><option>OK</option><option>NG</option></select></div>
        <div><label>冷却水 <span class="req">*</span></label><select id="arr_insp_coolant"><option value="">選択</option><option>OK</option><option>NG</option></select></div>

        <div><label>バッテリー <span class="req">*</span></label><select id="arr_insp_battery"><option value="">選択</option><option>OK</option><option>NG</option></select></div>
        <div><label>ホーン <span class="req">*</span></label><select id="arr_insp_horn"><option value="">選択</option><option>OK</option><option>NG</option></select></div>
        <div><label>ミラー <span class="req">*</span></label><select id="arr_insp_mirror"><option value="">選択</option><option>OK</option><option>NG</option></select></div>

        <div><label>外装/破損 <span class="req">*</span></label><select id="arr_insp_damage"><option value="">選択</option><option>OK</option><option>NG</option></select></div>
        <div><label>積載状態 <span class="req">*</span></label><select id="arr_insp_cargo"><option value="">選択</option><option>OK</option><option>NG</option></select></div>
        <div><label>消火器 <span class="req">*</span></label><select id="arr_insp_ext"><option value="">選択</option><option>OK</option><option>NG</option></select></div>

        <div><label>三角停止板 <span class="req">*</span></label><select id="arr_insp_triangle"><option value="">選択</option><option>OK</option><option>NG</option></select></div>
        <div><label>工具/安全備品 <span class="req">*</span></label><select id="arr_insp_tools"><option value="">選択</option><option>OK</option><option>NG</option></select></div>
        <div><label>その他異常 <span class="req">*</span></label><select id="arr_insp_other"><option value="">選択</option><option>なし</option><option>あり</option></select></div>
      </div>

      <label>点検メモ（任意：NG/異常は必ず詳細）</label>
      <textarea id="arr_insp_note" placeholder="NG/異常の詳細を記載"></textarea>

      <label>異常箇所写真（任意：NG時推奨）</label>
      <input id="arr_abnormalPhoto" type="file" accept="image/*">

      <hr class="sep">
      <h3 class="h3">日報（PDF提出用）</h3>
      <div class="grid grid2">
        <div><label>業務内容 <span class="req">*</span></label><input id="arr_workType" type="text" placeholder="例：Amazon配送"></div>
        <div><label>配送エリア <span class="req">*</span></label><input id="arr_workArea" type="text" placeholder="例：姶良市"></div>
      </div>
      <div class="grid grid3">
        <div><label>稼働時間 <span class="req">*</span></label><input id="arr_workHours" type="text" placeholder="例：9:00-20:45"></div>
        <div><label>配送個数（任意）</label><input id="arr_deliveryCount" type="number" min="0" step="1" placeholder="例：198"></div>
        <div><label>トラブル/事故（任意）</label><input id="arr_trouble" type="text" placeholder="なければ「なし」"></div>
      </div>
      <label>日報メモ（詳細：引継ぎ/改善）</label>
      <textarea id="arr_dailyNote" placeholder="例：再配達○件、注意点、引継ぎなど"></textarea>

      <label>日報添付写真（任意：日報のみ）</label>
      <input id="arr_reportPhotos" type="file" accept="image/*" multiple>

      <div class="btnrow">
        <button class="btn rainbow" id="btnSubmitArrival" type="button">送信（帰着点呼・日報）</button>
      </div>
      <small class="hint">※送信後：スプレッドシート保存＋日報PDFはDriveにカラー保存（リンク返却）</small>
    </section>

    <!-- MY EXPORT -->
    <section id="viewMy" class="card rainbow-border hidden">
      <div class="sectionTop">
        <h2 class="h2">自分：出力（PDF / 月報CSV）</h2>
        <button class="btn ghost" id="backFromMy" type="button">戻る</button>
      </div>

      <div class="grid grid2">
        <div><label>対象日（日報PDF） <span class="req">*</span></label><input id="my_dailyDate" type="date"></div>
        <div class="alignBottom">
          <button class="btn dark" id="btnMyDailyPdf" type="button">日報PDFを作成（Drive保存→リンク）</button>
        </div>
      </div>

      <div class="grid grid2">
        <div><label>対象年月（月報） <span class="req">*</span></label><input id="my_month" type="month"></div>
        <div class="alignBottom">
          <button class="btn dark" id="btnMyMonthlyCsv" type="button">月報CSV（自分）</button>
          <button class="btn dark" id="btnMyMonthlyPdf" type="button">月報PDF（自分）</button>
        </div>
      </div>

      <small class="hint">※月報は写真の有無のみ記載（写真データ自体は日報のみ）</small>
    </section>

    <!-- ADMIN -->
    <section id="viewAdmin" class="card rainbow-border hidden">
      <div class="sectionTop">
        <h2 class="h2">管理者：検索 / 出力</h2>
        <button class="btn ghost" id="backFromAdmin" type="button">戻る</button>
      </div>

      <div class="grid grid3">
        <div><label>氏名（部分一致）</label><input id="ad_name" type="text" placeholder="例：森下"></div>
        <div><label>電話（部分一致）</label><input id="ad_phone" type="text" placeholder="080..."></div>
        <div><label>車両番号（部分一致）</label><input id="ad_vehicle" type="text" placeholder="21-15"></div>
      </div>

      <div class="grid grid2">
        <div><label>日付（開始）</label><input id="ad_from" type="date"></div>
        <div><label>日付（終了）</label><input id="ad_to" type="date"></div>
      </div>

      <div class="btnrow">
        <button class="btn dark" id="btnAdminSearch" type="button">検索</button>
        <button class="btn dark" id="btnAdminMonthlyCsv" type="button">月報CSV（全員）</button>
        <button class="btn dark" id="btnAdminMonthlyPdf" type="button">月報PDF（全員）</button>
      </div>

      <div id="adminResult" class="result"></div>
      <small class="hint">※管理者出力は管理者ログイン必須（GAS側でも管理パス照合）</small>
    </section>

    <footer class="foot">
      <small class="hint">© OFA GROUP</small>
    </footer>
  </div>

  <div id="toast" class="toast"></div>

  <script src="./app.js"></script>
</body>
</html>
